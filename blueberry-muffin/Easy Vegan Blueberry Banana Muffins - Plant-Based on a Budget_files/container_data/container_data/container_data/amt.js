(()=>{"use strict";var e={9109:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=a(9791);let n;(0,a(111).isApiStreamEnabled)("production")&&(n=e=>t=>{const a=t.map(e=>{const{id:t,target:a,adLocation:n,loadingStatus:r,adDimensions:o}=e;return(0,i.addCreativeIdAttributeToAdTarget)(a,t),{id:t,attribute:i.ID_ATTRIBUTE,adLocation:n,loadingStatus:r,adDimensions:o}});e.postMessage(JSON.stringify({type:"ad",data:a}))}),t.default=n},6725:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});let i;(0,a(111).isApiStreamEnabled)("production")&&(i=e=>t=>{e.postMessage(JSON.stringify({type:"event",data:t}))}),t.default=i},395:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchApiData=t.setupApiStream=t.getCustomEventDetailByAd=void 0;const n=i(a(9109)),r=i(a(6725)),o=a(111),s=a(1207),d=a(7098);let l;t.setupApiStream=l;let c=()=>{};t.dispatchApiData=c,(0,o.isApiStreamEnabled)("production")&&(t.setupApiStream=l=()=>{if(window&&window.Worker){const e=new Blob(["onmessage = function(e) { postMessage(e.data) }"]),t=window.URL.createObjectURL(e),a=new window.Worker(t),i=new CustomEvent("amt-api-init",{detail:a});return d.Logger.log("AMT API configured. Events will be dispatched.."),window.dispatchEvent(i),{sendAds:n.default&&(0,n.default)(a),sendEvents:r.default&&(0,r.default)(a)}}return null}),(0,o.isApiStreamEnabled)("production")&&(t.dispatchApiData=c=(e,t,a)=>{var i,n;switch(t){case"ad":null===(i=null==e?void 0:e.sendAds)||void 0===i||i.call(e,a);break;case"event":null===(n=null==e?void 0:e.sendEvents)||void 0===n||n.call(e,a);break;default:d.Logger.log("type is not supported: "+t)}});t.getCustomEventDetailByAd=e=>{var t;const{id:a,target:i}=e,n=e.getAdDimensions();return{id:a,adLocation:(0,s.getAdLocationRelativeToViewport)(e),loadingStatus:null===(t=i.ownerDocument)||void 0===t?void 0:t.readyState,adDimensions:n}}},6752:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.app=void 0;const i=a(5448),n=a(5887),r=a(4528),o=a(1259),s=a(6048),d=a(7240),l=a(1915),c=a(1169),u=a(7162),g=a(111),p=a(2756),E=a(5751),v=a(7098),_=a(395),T=a(8454),m=a(6419),A=a(129),b=a(6245),I=(a(2943),a(8235),a(3466)),h=a(1101),f=a(6581),S=a(3003),y=a(3876),O=a(2002);t.app={run:e=>{new i.LogDispatcher({eventBus:n.globalEventBus,apiToken:r.config.logging.token,apiUrl:r.config.logging.apiUrl}).init();const t=(0,o.getCurrentScript)(document);if(t){const e=(0,s.createAmtDomScript)(t);d.systemStore.set("script",e),d.creativeStore.set("entities",(0,l.getEntityInformation)(e)),d.creativeStore.set("richMediaParams",(0,c.getRichMediaQueryParams)(e)),d.creativeStore.set("tagAttributes",(0,u.getTagAttributes)(e)),e.srcString&&d.creativeStore.set("macros",(0,u.getAllPlatformMacros)(e))}(0,g.isApiStreamEnabled)("production")&&d.apiStore.actions.setupVisionProjectApiStream();const a=(0,E.getSupportedDataVendor)(d.systemStore.get("script").srcString),M=d.creativeStore.get("macros").custom,R=d.creativeStore.get("tagAttributes"),P=null==R?void 0:R.code;P&&(v.Logger.log("start to disable dispatching and retrieve tag config..."),d.apiStore.set("disableEventDispatch",!0),(0,u.getTagConfigFromEventCollectionCache)(P,M));const w=(0,u.getTag)(R,r.config.macroTag.defaultConfig,M);if(!M||!w||"cm360"!==w.platform||"x"!==M.attr2&&"/"!==M.attr2)try{if((0,g.isApiStreamEnabled)("production")){const t=d.apiStore.get("apiFeed");t&&(0,_.dispatchApiData)(t,"event",[{phase:T.AMTCustomEventPhase.AMT_ADDED}]),(0,m.addPauseNotificationListener)(e),(0,m.addResumeNotificationListener)(e)}try{(0,A.checkVpClient)(e=>{"error"in e?v.Logger.error(e.error):d.vpStore.set("visionProjectClient",e)})}catch(e){v.Logger.error(e.message)}const i=d.creativeStore.get("macros"),n=d.creativeStore.get("richMediaParams");if((0,b.isTopWindow)(e))(0,I.isInjectedAmt)(t)?(v.Logger.debug("amt injected"),(0,h.instantiatePageMode)(i,w,a)):e.document.readyState===f.ReadyState.LOADING?(v.Logger.debug("Setting up event listener"),e.document.addEventListener("DOMContentLoaded",()=>{v.Logger.debug("instantiate page mode in event listener!"),(0,h.instantiatePageMode)(i,w,a)})):(v.Logger.debug("dom already loaded so let's immediately instantiate page mode!"),(0,h.instantiatePageMode)(i,w,a));else{const e=e=>{(0,S.instantiateCreativeMode)(i,n,w,e)};(0,y.isRichMediaVendor)(null==n?void 0:n.richMediaVendor)?(0,O.pollFor)(()=>null!==d.vpStore.get("visionProjectClient"),()=>e({name:p.DataVendorName.VISION_PROJECT}),()=>e(a),{interval:100,maxWaitTime:1e3}):e(a)}}catch(e){v.Logger.error("Error - "+e.message,e)}}}},1373:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=a(6051),n=a(7520);a(7098);let r={macroTag:{defaultConfig:n.developmentMacroTag,apiUrl:"MISSING_ENV_VAR".MACRO_TAG_CONFIG_API_URL||"http://localhost:8888/api/tag/config"},adSampling:{pageMode:100,creativeMode:i.sampleRatesDev},eventCollection:{apiUrl:"MISSING_ENV_VAR".DEV_COLLECTION_API_URL||"http://localhost:8888/api/event",enabled:"true"==="MISSING_ENV_VAR".DEV_COLLECTION_API_ENABLED,maxSessionLengthSeconds:1200,token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJhbXQtc3RhZ2luZyJ9.M2aYvp29Ht2W3_viaNMJnA92yXjBa_R7-mC7TTP_pLg"},qaServer:{url:"http://localhost:3000",path:"/socket"},logging:{apiUrl:"MISSING_ENV_VAR".LOGGING_API_URL||"http://localhost:8888/api/log",token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJhbXQtc3RhZ2luZyJ9.M2aYvp29Ht2W3_viaNMJnA92yXjBa_R7-mC7TTP_pLg"}};t.default=r},6473:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=a(6051),n=a(7520);t.default={macroTag:{defaultConfig:n.productionMacroTag,apiUrl:"https://api.attentionxyz.com/api/tag/config"},adSampling:{pageMode:0,creativeMode:i.sampleRatesProd},eventCollection:{apiUrl:"https://api.attentionxyz.com/api/event",enabled:!0,maxSessionLengthSeconds:1200,token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJhbXQtcHJvZCJ9.8dotrQPk6rXdTZUfYiTmmCx3BKBZ0ngS9huOY_9Rk9s"},qaServer:{url:"https://qatool.decoupled-attention.staging.playground.xyz",path:"/socket"},logging:{apiUrl:"https://api.attentionxyz.com/api/log",token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJhbXQtcHJvZCJ9.8dotrQPk6rXdTZUfYiTmmCx3BKBZ0ngS9huOY_9Rk9s"}}},5763:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=a(6051),n=a(7520);t.default={macroTag:{defaultConfig:n.stagingMacroTag,apiUrl:"https://event-collection-api.decoupled-attention.staging.playground.xyz/api/tag/config"},adSampling:{pageMode:100,creativeMode:i.sampleRatesStg},eventCollection:{apiUrl:"https://event-collection-api.decoupled-attention.staging.playground.xyz/api/event",enabled:!0,maxSessionLengthSeconds:1200,token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJhbXQtc3RhZ2luZyJ9.M2aYvp29Ht2W3_viaNMJnA92yXjBa_R7-mC7TTP_pLg"},qaServer:{url:"https://qatool.decoupled-attention.staging.playground.xyz",path:"/socket"},logging:{apiUrl:"https://event-collection-api.decoupled-attention.staging.playground.xyz/api/log",token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJhbXQtc3RhZ2luZyJ9.M2aYvp29Ht2W3_viaNMJnA92yXjBa_R7-mC7TTP_pLg"}}},403:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=a(6051),n=a(7520);t.default={macroTag:{defaultConfig:n.testingMacroTag,apiUrl:"http://localhost/test"},adSampling:{pageMode:100,creativeMode:i.sampleRatesTest},eventCollection:{apiUrl:"http://localhost/test",enabled:!0,maxSessionLengthSeconds:1e3,token:"some.test.token"}}},4528:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const n=i(a(1373)),r=i(a(6473)),o=i(a(5763)),s=i(a(403)),d={development:n.default,production:r.default,staging:o.default,testing:s.default};t.config=d.production},2831:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.supportedDataVendors=void 0;const i=a(2756);t.supportedDataVendors=[{name:i.DataVendorName.VISION_PROJECT}]},6289:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.featureConfig=void 0;const i=a(6581);t.featureConfig={browsingFeatures:!0,imageCapture:{enabled:!1,ratio:1},zoneIntervals:{[i.Zone.TARGET_ZONE]:100,[i.Zone.ZONE_2]:2e3}}},497:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.supportedIABAdFormats=t.SIZE_TOLERANCE=void 0,t.SIZE_TOLERANCE=10,t.supportedIABAdFormats=[{type:"mrec",width:300,height:250,enabled:!0,tolerance:115},{type:"banner",width:320,height:50,enabled:!0,tolerance:80},{type:"half-page",width:300,height:600,enabled:!0,tolerance:25},{type:"leaderboard",width:728,height:90,enabled:!0,tolerance:30},{type:"wide-skyscraper",width:160,height:600,enabled:!0,tolerance:21},{type:"portrait",width:300,height:1050,enabled:!0},{type:"skyscraper",width:120,height:600,enabled:!0},{type:"large-leaderboard",width:970,height:90,enabled:!0},{type:"vertical-banner",width:120,height:240,enabled:!0},{type:"full-banner",width:468,height:60,enabled:!0},{type:"half-banner",width:234,height:60,enabled:!0},{type:"interstitial",width:320,height:480,enabled:!0},{type:"billboard",width:970,height:250,enabled:!0}]},7520:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.testingMacroTag=t.developmentMacroTag=t.stagingMacroTag=t.productionMacroTag=void 0,t.productionMacroTag={global:{sampleRate:.1}},t.stagingMacroTag={global:{sampleRate:1}},t.developmentMacroTag={global:{sampleRate:1}},t.testingMacroTag={global:{sampleRate:1}}},6051:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sampleRatesTest=t.sampleRatesDev=t.sampleRatesStg=t.sampleRatesProd=void 0,t.sampleRatesProd={"a3461db0-9e6c-11eb-ae5d-25d016c269e9":{sampleRate:0},"972ce310-9e6c-11eb-ae5d-25d016c269e9":{sampleRate:0},"8d09fa30-9e6c-11eb-ae5d-25d016c269e9":{sampleRate:0},"7f3ca6f0-9e6c-11eb-ae5d-25d016c269e9":{sampleRate:0},"cb67a520-c405-11eb-b16c-cbc41f50a1d0":{sampleRate:10},"31109490-f967-11eb-9065-41de5c358b0f":{sampleRate:2},"0533ffe0-7566-11eb-94d7-7715e4928253":{sampleRate:0},"12b2e500-7566-11eb-94d7-7715e4928253":{sampleRate:0},"31df3dc0-7566-11eb-94d7-7715e4928253":{sampleRate:0},"459d41e0-7566-11eb-94d7-7715e4928253":{sampleRate:0},"3b593c70-7566-11eb-94d7-7715e4928253":{sampleRate:0},"26f2c350-7566-11eb-94d7-7715e4928253":{sampleRate:0},"43374100-8612-11eb-ba88-fba96c750aa4":{sampleRate:0},"4b0e1700-8612-11eb-ba88-fba96c750aa4":{sampleRate:0},"5cb940b0-8612-11eb-ba88-fba96c750aa4":{sampleRate:0},"6881c340-8612-11eb-ba88-fba96c750aa4":{sampleRate:0},"71746980-8612-11eb-ba88-fba96c750aa4":{sampleRate:0},"79962b30-8612-11eb-ba88-fba96c750aa4":{sampleRate:0},"8792f2e0-8612-11eb-ba88-fba96c750aa4":{sampleRate:0},"8c43a9b0-8612-11eb-ba88-fba96c750aa4":{sampleRate:0}},t.sampleRatesStg={},t.sampleRatesDev={"222lineitem222":{sampleRate:0},"333lineitem333":{sampleRate:50},"555lineitem555":{sampleRate:50},"666lineitem666":{sampleRate:50},"888lineitem888":{sampleRate:50},"999lineitem999":{sampleRate:100}},t.sampleRatesTest={12345:{sampleRate:50},23456:{sampleRate:50}}},4405:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0},5990:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateLoadEventInStoredBatch=t.captureAdLoadEvent=t.getUpdatedTagInCapturing=void 0;const i=a(6001),n=a(6332),r=a(7240),o=a(9727),s=a(7098);t.getUpdatedTagInCapturing=(e,t)=>t&&e?Object.assign(Object.assign({},e),{sampleRate:t.sampleRate,overriddenByEntity:t.overriddenByEntity}):e;t.captureAdLoadEvent=(e,t)=>{const a=o.globalEventFactory.create(e,t);r.apiStore.actions.insertRawEvents([a]),(0,i.addToManagedTimelineDispatch)()};t.updateLoadEventInStoredBatch=(e,t,a)=>{const i=e.find(e=>e.type===n.EventType.LOAD_EVENT);if(i&&i.tag){const e=Object.assign(Object.assign({},i),{tag:Object.assign(Object.assign({},i.tag),{sampleRate:t,overriddenByEntity:a})});s.Logger.log("updated load event with tag: ",e.tag),r.apiStore.actions.replaceEventInStoredBatch(e)}}},3314:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initialiseBrowsingFeatures=t.captureBrowsingFeatures=t.createInterval=t.createBrowsingFeaturesIntervalCallback=void 0;const i=a(2715),n=a(1207),r=a(6001),o=a(6376),s=a(6289),d=a(391),l=a(6581),c=a(5887),u=a(9727),g=a(7240);t.createBrowsingFeaturesIntervalCallback=e=>()=>{const t=(e=>{const t=[];return g.adStore.queries.adsForZone(e).forEach(e=>{e.isAdTargetValid()?t.push(e):(0,o.removeAdTarget)(e)}),t})(e);if(0===t.length)return;const a=t.map(e=>u.globalEventFactory.create("amt:measure:browsing-features",{id:e.id,browsingFeatures:{scrollPosition:window.top?(0,i.getScrollPosition)(window.top):0,adLocation:(0,n.getAdLocation)(e.target.getBoundingClientRect())}}));g.apiStore.actions.insertIntervalEvents(a),(0,r.batchDispatchIntervalEvents)(),a.forEach(e=>{e.browsingFeatures&&c.globalEventBus.publish("ad:rectangle-change",{adId:e.id,rect:e.browsingFeatures.adLocation})})};t.createInterval=(e,t)=>window.setInterval(e,s.featureConfig.zoneIntervals[t]);t.captureBrowsingFeatures=e=>(0,t.createInterval)((0,t.createBrowsingFeaturesIntervalCallback)(e),e);t.initialiseBrowsingFeatures=e=>{const a=Object.values(l.Zone).map(a=>({id:(0,t.captureBrowsingFeatures)(a),zone:a,mode:e}));g.measurementStore.actions.insertBrowsingDynamicsIntervals(a),(0,d.instantiateZoneCheckingInterval)()}},4989:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.captureGaze=void 0;const i=a(5751);t.captureGaze=(e,t,a,n)=>{window.top&&Object.values(window.top[i.XYZ_AMT_NAMESPACE].__handlers__).forEach(i=>{i(e,t,a,n)})}},7177:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processVisionProjectGaze=t.createVisionProjectGazeEvents=void 0;const i=a(82),n=a(8497),r=a(395),o=a(8454),s=a(1207),d=a(5887),l=a(6001),c=a(9727),u=a(7240);t.createVisionProjectGazeEvents=e=>e.map(e=>c.globalEventFactory.create("amt:measure:gaze",e));t.processVisionProjectGaze=(e,a,c,g)=>{const p=u.adStore.get("detectedAds"),E=(0,i.getCurrentTimestamp)(),v=p.map(t=>{const i=t.target.getBoundingClientRect(),n=(0,s.getAdLocation)(i);return{id:t.id,timestamp:E,inGaze:t.isInGaze({x:e,y:a}),adLocation:n}});p.forEach(e=>{(0,r.dispatchApiData)(u.apiStore.get("apiFeed"),"event",[Object.assign({phase:o.AMTCustomEventPhase.AMT_GAZE_DATA_RECEIVED,payload:v.filter(t=>t.id===e.id)},(0,r.getCustomEventDetailByAd)(e))])});const _={x:e,y:a,gazeVendor:c,gazeIdentifiers:g},T=(0,n.getValidGazeInput)(_),m=v.map(e=>Object.assign(Object.assign({},e),T)),A=(0,t.createVisionProjectGazeEvents)(m);u.apiStore.actions.insertIntervalEvents(A),(0,l.batchDispatchIntervalEvents)(),d.globalEventBus.publish("vp:gaze",{x:e,y:a,timestamp:E,identifiers:g,vendor:c}),m.forEach(e=>{d.globalEventBus.publish("ad:in-gaze-status",{adId:e.id,inGaze:e.inGaze})})}},9732:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initialiseDataVendor=void 0;const i=a(2756),n=a(8235);t.initialiseDataVendor=e=>{switch(e){case i.DataVendorName.VISION_PROJECT:(0,n.initialiseVisionProject)()}}},8235:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initialiseVisionProject=t.initialiseGazeExposedFunction=void 0;const i=a(4989),n=a(7177),r=a(5751),o=a(395),s=a(8454),d=a(7240);t.initialiseGazeExposedFunction=()=>{if(!window.top)return;void 0===window.top[r.XYZ_AMT_NAMESPACE]?window.top[r.XYZ_AMT_NAMESPACE]={ongaze:i.captureGaze,__handlers__:{[d.systemStore.get("instanceId")]:n.processVisionProjectGaze}}:window.top[r.XYZ_AMT_NAMESPACE].__handlers__[d.systemStore.get("instanceId")]||(window.top[r.XYZ_AMT_NAMESPACE].__handlers__[d.systemStore.get("instanceId")]=n.processVisionProjectGaze);const e=d.apiStore.get("apiFeed");d.adStore.get("detectedAds").forEach(t=>{(0,o.dispatchApiData)(e,"event",[Object.assign({phase:s.AMTCustomEventPhase.AMT_GLOBAL_HANDLER_INITIALISED},(0,o.getCustomEventDetailByAd)(t))]),window.top&&Object.keys(window.top[r.XYZ_AMT_NAMESPACE].__handlers__).length>0&&(0,o.dispatchApiData)(e,"event",[Object.assign({phase:s.AMTCustomEventPhase.AMT_INTERNAL_HANDLER_ADDED},(0,o.getCustomEventDetailByAd)(t))])})};t.initialiseVisionProject=()=>{(0,t.initialiseGazeExposedFunction)()}},5751:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSupportedDataVendor=t.captureDataVendorFeatureEvents=t.XYZ_AMT_NAMESPACE=void 0;const i=a(9732),n=a(2831),r=a(111),o=a(7098);t.XYZ_AMT_NAMESPACE="__xyz_amt__";t.captureDataVendorFeatureEvents=e=>{e&&e.name?(0,i.initialiseDataVendor)(e.name):o.Logger.error("The data vendor is not supported")};t.getSupportedDataVendor=e=>n.supportedDataVendors.find(t=>((0,r.getDataVendorAttribute)(e)||"").indexOf(t.name)>=0)||null},8497:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getValidGazeInput=void 0;const a=e=>"number"==typeof e?e:void 0,i=e=>"string"==typeof e?e:void 0;t.getValidGazeInput=e=>{const{x:t,y:n,gazeVendor:r,gazeIdentifiers:o}=e,s={};return s.x=a(t),s.y=a(n),s.gazeVendor=i(r),s.gazeIdentifiers="object"==typeof o&&null!==o?{pageId:i(o.pageId),sessionId:i(o.sessionId),feedId:i(o.feedId),userId:i(o.userId)}:void 0,s}},7623:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.captureEndEvent=void 0;const i=a(6001),n=a(9727),r=a(7240);t.captureEndEvent=(e,t)=>{const a=n.globalEventFactory.create("amt:adswap:end",{id:e.id,endReason:t});r.apiStore.actions.insertRawEvents([a]),(0,i.addToManagedTimelineDispatch)()}},9402:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.captureImages=t.ratioImageCaptureEventCreation=t.createImageCaptureEvent=void 0;const i=a(6289),n=a(3194),r=a(6001),o=a(9727),s=a(7240);t.createImageCaptureEvent=e=>{const t=(0,n.getDeepestAvailableHTMLContent)(e.target);return t?o.globalEventFactory.create("amt:offline:image",{id:e.id,adContent:t}):null};t.ratioImageCaptureEventCreation=e=>Math.random()<=i.featureConfig.imageCapture.ratio?(0,t.createImageCaptureEvent)(e):null;t.captureImages=e=>{const a=e.map(t.ratioImageCaptureEventCreation).filter(e=>!!e);s.apiStore.actions.insertRawEvents(a),(0,r.addToManagedTimelineDispatch)()}},8679:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.captureVideoIntersectionObserverEvents=t.createVideoIntersectionObserverEventHandler=t.captureIntersectionObserverEvents=t.createIntersectionObserverEventHandler=void 0;const i=a(6001),n=a(3628),r=a(423),o=a(5887),s=a(9727),d=a(7240);t.createIntersectionObserverEventHandler=(e,t)=>a=>{if(d.vpStore.get("adTargetAdSwapStatusMapping")[e.id]!==r.AdSwapStatusEnum.PAUSED){const n=(new Date).getTime(),r=a.map(a=>s.globalEventFactory.create("amt:measure:inview",{ad:e,timestamp:n,inView:a.intersectionRatio,richMediaParams:t}));d.apiStore.actions.insertRawEvents(r),(0,i.addToManagedTimelineDispatch)();const l=a[a.length-1];o.globalEventBus.publish("ad:rectangle-change",{adId:e.id,rect:l.boundingClientRect})}};t.captureIntersectionObserverEvents=(e,a)=>{const i=d.creativeStore.get("richMediaParams");(0,n.instantiateIntersectionObserver)((0,t.createIntersectionObserverEventHandler)(e,i),e,a)};t.createVideoIntersectionObserverEventHandler=e=>{const t=e.sort((e,t)=>t.time-e.time);if(t.length){const e=t[0];e.isIntersecting?d.youtubeStore.set("currentVideoInViewPercentage",e.intersectionRatio):d.youtubeStore.set("currentVideoInViewPercentage",0)}};t.captureVideoIntersectionObserverEvents=(e,a)=>{(0,n.instantiateIntersectionObserver)(t.createVideoIntersectionObserverEventHandler,e,a)}},451:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.capturePageEvent=void 0;const i=a(6001),n=a(9727),r=a(7240);t.capturePageEvent=(e,t)=>{const a=n.globalEventFactory.create("amt:metadata:page",{id:t.id,win:e});r.apiStore.actions.insertRawEvents([a]),(0,i.addToManagedTimelineDispatch)()}},9500:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSyntheticIntersectionEvents=t.convertLatestIntersectionEventsToSyntheticEvents=t.updateLatestIntersectionEventPerImpression=t.filterTimelineForIntersectionEvents=t.getLatestIntersectionEventPerImpression=void 0;const i=a(6881),n=a(4616),r=a(6332),o=a(9666),s=a(7240);t.getLatestIntersectionEventPerImpression=e=>e.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.id]:t}),{});t.filterTimelineForIntersectionEvents=e=>e.filter(e=>"number"==typeof e.inView);t.updateLatestIntersectionEventPerImpression=()=>{const e=(0,t.filterTimelineForIntersectionEvents)(s.apiStore.get("rawEventTimeline")),a=(0,t.getLatestIntersectionEventPerImpression)(e);s.measurementStore.actions.insertSyntheticEventLookup(o.SyntheticEventTypes.INTERSECTION,a)};t.convertLatestIntersectionEventsToSyntheticEvents=e=>{const t=s.adStore.get("detectedAds"),a=t.map(e=>e.id),o=s.creativeStore.get("richMediaParams"),{richMediaFormat:d=null}=o||{};return Object.values(e).filter(e=>a.includes(e.id)).map(e=>{const a=t.find(t=>t.id===e.id),o=a?(0,n.getAdFormat)({richMediaFormat:d,target:a.target,window:a.topMostAccessibleFrameWindow}):e.format;return{id:e.id,inView:e.inView,type:r.EventType.MEASURE_EVENT,timestamp:(new Date).getTime(),windowDimensions:(0,i.getWindowDimensions)(window),adDimensions:a?a.getAdDimensions():e.adDimensions,format:o}})};t.getSyntheticIntersectionEvents=()=>{const e=s.measurementStore.get("syntheticEventLookup")[o.SyntheticEventTypes.INTERSECTION];return(0,t.convertLatestIntersectionEventsToSyntheticEvents)(e)}},3048:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.captureTriggeredEvent=void 0;const i=a(6001),n=a(7240);t.captureTriggeredEvent=e=>{n.apiStore.actions.insertRawEvents([e]),(0,i.addToManagedTimelineDispatch)()}},4278:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.captureVideoProgressEvent=void 0;const i=a(6001),n=a(7240);t.captureVideoProgressEvent=e=>{n.apiStore.actions.insertRawEvents([e]),(0,i.addToManagedTimelineDispatch)()}},2030:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.captureVideoStateMeasureEvent=void 0;const i=a(6001),n=a(9727),r=a(7240);t.captureVideoStateMeasureEvent=(e,t,a)=>{const o=n.globalEventFactory.create("amt:youtube:video-state",{adId:e.id,currentTime:t,totalViewableTime:a,originalEventTimestamp:Date.now()});r.apiStore.actions.insertIntervalEvents([o]),(0,i.batchDispatchIntervalEvents)()}},3680:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.captureViewableEvent=void 0;const i=a(6001),n=a(9727),r=a(7240);t.captureViewableEvent=(e,t,a)=>{const o=n.globalEventFactory.create("amt:youtube:viewable",{adId:e.id,totalIabViewableTime:t,viewableTimeViewportCoverageIntervals:a,originalEventTimestamp:Date.now()});r.apiStore.actions.insertRawEvents([o]),(0,i.addToManagedTimelineDispatch)()}},9630:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pollForVpMetadata=void 0;const i=a(6001),n=a(2002),r=a(9727),o=a(7098),s=a(7240),d=["feedId","userId","pageId"],l=["studyId","adCampaignId"],c=(e,t,a)=>{if("object"!=typeof(i=t)||null===i||!d.every(e=>"string"==typeof i[e])||!l.every(e=>["string","undefined"].includes(typeof i[e])))return o.Logger.error("Vision Project data invalid",t),null;var i;const n=[...d,...l].reduce((e,a)=>{var i;return e[a]=null!==(i=t[a])&&void 0!==i?i:null,e},{});return r.globalEventFactory.create("amt:metadata:vision-project-metadata",{id:e.id,vpMetadata:Object.assign(Object.assign({},n),a)})};t.pollForVpMetadata=e=>{if(!e.pageAccess)return void o.Logger.warn("No page access to poll! "+window.location.href);(0,n.pollFor)(()=>{var e;return void 0!==(null===(e=window.top)||void 0===e?void 0:e.__vp_metadata__)},()=>{var t;const a=s.vpStore.get("visionProjectClient");if(null===(t=window.top)||void 0===t?void 0:t.__vp_metadata__){const t=c(e,window.top.__vp_metadata__,a);t&&(s.apiStore.actions.insertRawEvents([t]),(0,i.addToManagedTimelineDispatch)())}},()=>o.Logger.warn("Timeout: VP Metadata"),{interval:500,maxWaitTime:2e4})}},4616:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getYouTubeAdFormat=t.getAdFormat=t.findMatchingIABFormat=void 0;const i=a(3194),n=a(497);t.findMatchingIABFormat=e=>n.supportedIABAdFormats.find(t=>(0,i.iframeSizeComparison)(e,t));t.getAdFormat=e=>{if(e.richMediaFormat)return e.richMediaFormat;const{target:a}=e,i=(0,t.findMatchingIABFormat)(a);return(null==i?void 0:i.type)||null};t.getYouTubeAdFormat=e=>{var t;return e?"youtube-in-stream-"+(null===(t=e.youtube)||void 0===t?void 0:t.adType):null}},5898:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLocation=void 0;const i=a(8842),n=a(5887);t.getLocation=e=>{if(e.top===e.self)return n.globalEventBus.publish("debug:referrer",{referrer:e.location.href,origin:i.ReferrerOrigin.WINDOW_HREF}),e.location.href;try{return n.globalEventBus.publish("debug:referrer",{referrer:e.top.location.href,origin:i.ReferrerOrigin.WINDOW_HREF}),e.top.location.href}catch(t){return e.document.referrer?(n.globalEventBus.publish("debug:referrer",{referrer:e.document.referrer,origin:i.ReferrerOrigin.WINDOW_REFERRER}),e.document.referrer):e.document.URL?(n.globalEventBus.publish("debug:referrer",{referrer:e.document.URL,origin:i.ReferrerOrigin.WINDOW_URL}),e.document.URL):e.document.baseURI?(n.globalEventBus.publish("debug:referrer",{referrer:e.document.baseURI,origin:i.ReferrerOrigin.WINDOW_BASE_URI}),e.document.baseURI):(n.globalEventBus.publish("debug:referrer",{referrer:"",origin:null}),"")}}},1207:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAdLocationRelativeToViewport=t.getAdLocation=void 0;const i=a(8454),n=a(3648);t.getAdLocation=e=>({top:Math.round(e.top),left:Math.round(e.left),right:Math.round(e.right),bottom:Math.round(e.bottom),x:Math.round(e.x),y:Math.round(e.y),height:Math.round(e.height),width:Math.round(e.width)});t.getAdLocationRelativeToViewport=e=>{const a=(0,t.getAdLocation)(e.target.getBoundingClientRect()),r=(0,n.getViewportForCreative)(window,e.topMostAccessibleFrameWindow);let o=null;const{left:s,right:d,top:l,bottom:c}=a,{height:u=0}=r||{};return o=c<0?i.LocationRelativeToViewport.ABOVE:l>u?i.LocationRelativeToViewport.BELOW:i.LocationRelativeToViewport.WITHIN,{left:s,right:d,top:l,bottom:c,locationRelativeToViewport:o}}},1878:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendSyntheticGazeEvent=t.isInGaze=void 0;const i=a(7240),n=a(1763),r=a(3426),o=a(2756),s=a(5751),d=a(6001),l=a(1207),c=a(9727);t.isInGaze=(e,t)=>{const{isActiveTab:a,adState:o}=i.youtubeStore.getMany("isActiveTab","adState");return!("number"!=typeof t.x||"number"!=typeof t.y||!(window.__amt_mode__!==n.Mode.YOUTUBE||a&&o===r.YOUTUBE_AD_STATE.PLAYING))&&(t.x>=e.left&&t.x<=e.right&&t.y>=e.top&&t.y<=e.bottom)};t.sendSyntheticGazeEvent=(e,t)=>{var a;if(!e||!e.name||e.name!==o.DataVendorName.VISION_PROJECT)return;if(!(null===(a=window.top)||void 0===a?void 0:a[s.XYZ_AMT_NAMESPACE]))return;const n=i.adStore.get("detectedAds"),r=n.length?n[0]:null,u=i.youtubeStore.get("video");if(r&&u){const e={id:r.id,timestamp:Date.now(),inGaze:t,adLocation:(0,l.getAdLocation)(r.adRect)},a=c.globalEventFactory.create("amt:measure:gaze",e);i.apiStore.actions.insertIntervalEvents([a]),(0,d.batchDispatchIntervalEvents)()}}},4611:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPageDimensions=void 0;t.getPageDimensions=e=>{var t,a;return{height:(null===(t=null==e?void 0:e.top)||void 0===t?void 0:t.document.documentElement.scrollHeight)||0,width:(null===(a=null==e?void 0:e.top)||void 0===a?void 0:a.document.documentElement.scrollWidth)||0}}},2715:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getScrollPosition=void 0;t.getScrollPosition=e=>Math.round(e.scrollY||e.pageYOffset)},9599:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewableUpdate=t.constructViewableStatus=t.getViewability=t.calculateUpdatedViewportCoverageIntervals=t.calculateViewableTimeDelta=t.hasMinimumConsecutiveIabViewableTime=t.getIabViewableTime=t.calculateViewableTime=t.isIabViewable=t.IAB_VIEWABLE_MIN_IN_VIEW_PERCENTAGE=t.IAB_VIEWABLE_MIN_CONSECUTIVE_VIDEO_DURATION=t.IAB_VIEWABLE_MIN_CONSECUTIVE_DISPLAY_VISBILITY=void 0;const i=a(7079),n=a(1763),r=a(7240);t.IAB_VIEWABLE_MIN_CONSECUTIVE_DISPLAY_VISBILITY=1e3,t.IAB_VIEWABLE_MIN_CONSECUTIVE_VIDEO_DURATION=2e3,t.IAB_VIEWABLE_MIN_IN_VIEW_PERCENTAGE=.5;t.isIabViewable=e=>e>=t.IAB_VIEWABLE_MIN_IN_VIEW_PERCENTAGE;t.calculateViewableTime=(e,t)=>Math.max(e+t,0);t.getIabViewableTime=(e,a,i,n)=>e?a:i>0&&(0,t.isIabViewable)(n)?(0,t.calculateViewableTime)(a,i):0;t.hasMinimumConsecutiveIabViewableTime=(e,a)=>{switch(e){case n.Mode.YOUTUBE:return a>=t.IAB_VIEWABLE_MIN_CONSECUTIVE_VIDEO_DURATION;case n.Mode.CREATIVE:case n.Mode.PAGE:return a>=t.IAB_VIEWABLE_MIN_CONSECUTIVE_DISPLAY_VISBILITY;default:return!1}};t.calculateViewableTimeDelta=(e,t)=>Math.max(t-e,0);t.calculateUpdatedViewportCoverageIntervals=(e,a,n)=>({[i.ViewportCoverageInterval.INTERVAL_0]:a>0?(0,t.calculateViewableTime)(e[i.ViewportCoverageInterval.INTERVAL_0],n):e[i.ViewportCoverageInterval.INTERVAL_0],[i.ViewportCoverageInterval.INTERVAL_25]:a>=.25?(0,t.calculateViewableTime)(e[i.ViewportCoverageInterval.INTERVAL_25],n):e[i.ViewportCoverageInterval.INTERVAL_25],[i.ViewportCoverageInterval.INTERVAL_50]:a>=.5?(0,t.calculateViewableTime)(e[i.ViewportCoverageInterval.INTERVAL_50],n):e[i.ViewportCoverageInterval.INTERVAL_50],[i.ViewportCoverageInterval.INTERVAL_75]:a>=.75?(0,t.calculateViewableTime)(e[i.ViewportCoverageInterval.INTERVAL_75],n):e[i.ViewportCoverageInterval.INTERVAL_75],[i.ViewportCoverageInterval.INTERVAL_100]:a>.99?(0,t.calculateViewableTime)(e[i.ViewportCoverageInterval.INTERVAL_100],n):e[i.ViewportCoverageInterval.INTERVAL_100]});t.getViewability=(e,a,n,r,o,s,d)=>{let l=0;n>0&&e&&(l=(0,t.calculateViewableTimeDelta)(o,a));const c=(0,t.calculateUpdatedViewportCoverageIntervals)(d,n,l),u=(0,t.getIabViewableTime)(r,s,l,n);return{totalViewableTime:c[i.ViewportCoverageInterval.INTERVAL_0],totalIabViewableTime:u,viewableTimeViewportCoverageIntervals:c}};t.constructViewableStatus=()=>({viewableCaptured:!1,previousElapsedTime:0,totalIabViewableTime:0,viewableTimeViewportCoverageIntervals:{[i.ViewportCoverageInterval.INTERVAL_0]:0,[i.ViewportCoverageInterval.INTERVAL_25]:0,[i.ViewportCoverageInterval.INTERVAL_50]:0,[i.ViewportCoverageInterval.INTERVAL_75]:0,[i.ViewportCoverageInterval.INTERVAL_100]:0}});t.getViewableUpdate=e=>{const{isActiveTab:a,currentVideoInViewPercentage:n,videoViewableStatus:o}=r.youtubeStore.getMany("isActiveTab","currentVideoInViewPercentage","videoViewableStatus");return o?null===n?{viewableCaptured:o.viewableCaptured,totalViewableTime:o.viewableTimeViewportCoverageIntervals[i.ViewportCoverageInterval.INTERVAL_0],totalIabViewableTime:o.totalIabViewableTime,viewableTimeViewportCoverageIntervals:o.viewableTimeViewportCoverageIntervals}:Object.assign({viewableCaptured:o.viewableCaptured},(0,t.getViewability)(a,e,n,o.viewableCaptured,o.previousElapsedTime,o.totalIabViewableTime,o.viewableTimeViewportCoverageIntervals)):null}},3648:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewportForCreative=t.getViewportDimensions=void 0;const i=a(6245),n=a(7098);t.getViewportDimensions=e=>({width:Math.max(e.document.documentElement.clientWidth,e.innerWidth||0),height:Math.max(e.document.documentElement.clientHeight,e.innerHeight||0)});t.getViewportForCreative=(e,a)=>(0,i.hasPageAccess)(a)&&a.top?(0,t.getViewportDimensions)(a.top):(0,i.hasPageAccess)(e)&&e.top?(0,t.getViewportDimensions)(e.top):(n.Logger.info("No viewport"),null)},6881:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getScreenDimensions=t.getWindowDimensions=void 0;t.getWindowDimensions=e=>({height:e.outerHeight,width:e.outerWidth});t.getScreenDimensions=e=>({height:e.screen.height,width:e.screen.width})},4259:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Store=void 0;t.Store=class{constructor(e){this.get=e=>{if(!(e in this.values))throw new Error("Key does not exist in the store");return this.values[e]},this.getMany=(...e)=>e.reduce((e,t)=>(e[t]=this.get(t),e),{}),this.set=(e,t)=>{if(!(e in this.values))throw new Error("Key does not exist in the store");const a=t instanceof Function?t(this.values[e]):t;return this.values[e]=a,a},this.values=Object.assign({},e)}}},3635:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createStoreAccessor=void 0;const a=e=>t=>Object.fromEntries(Object.entries(t).map(([t,a])=>[t,a(e)]));t.createStoreAccessor=e=>t=>({get:e.get,getMany:e.getMany,set:e.set,queries:a(e)(t.queries),actions:a(e)(t.actions)})},835:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventBus=void 0;t.EventBus=class{constructor(){this.callbacks={},this.publish=(e,t)=>{const a=this.callbacks[e];if(null==a?void 0:a.length)for(let e=0;e<a.length;e++)a[e](t)},this.subscribe=(e,t)=>{this.callbacks[e]?this.callbacks[e].find(e=>e===t)||this.callbacks[e].push(t):this.callbacks[e]=[t]},this.unsubscribe=(e,t)=>{this.callbacks[e]&&(this.callbacks[e]=this.callbacks[e].filter(e=>e!==t))}}}},1451:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;t.Factory=class{constructor(e){this.create=(e,...t)=>{if(!this.constructors[e])throw new TypeError(`Constructor for "${e}" not found`);return this.constructors[e](...t)},this.constructors=e.constructors}}},3003:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.instantiateCreativeMode=t.instantiateEventCollection=void 0;const i=a(6289),n=a(4528),r=a(8679),o=a(3314),s=a(9402),d=a(5990),l=a(451),c=a(5123),u=a(6245),g=a(3194),p=a(7240),E=a(9791),v=a(7162),_=a(6376),T=a(4814),m=a(5751),A=a(1763),b=a(6581),I=a(395),h=a(8454),f=a(9630),S=a(4616),y=a(5887),O=a(6001),M=a(6359),R=a(7098),P=a(1915),w=a(5341),L=a(4283);t.instantiateEventCollection=(e,t)=>{if((0,_.initialiseAdSession)(e),(0,r.captureIntersectionObserverEvents)(e,A.Mode.CREATIVE),[b.PageAccessType.FULL,b.PageAccessType.PARTIAL].includes(e.pageAccessType)){R.Logger.log("Data vendor name identified: "+(null==t?void 0:t.name)),R.Logger.log("Current creative ad id: "+e.id);const a=e.pageAccessType===b.PageAccessType.FULL?e.topMostAccessibleFrameWindow:window;(0,m.captureDataVendorFeatureEvents)(t),(0,l.capturePageEvent)(a,e),e.pageAccessType===b.PageAccessType.FULL&&i.featureConfig.browsingFeatures&&e.zone&&(0,o.initialiseBrowsingFeatures)(A.Mode.CREATIVE),e.pageAccessType===b.PageAccessType.FULL&&i.featureConfig.imageCapture.enabled&&(0,s.captureImages)([e])}};const N=(e,t)=>{var a;if("gumgum"===(null==t?void 0:t.richMediaVendor)){const i=null===(a=e.target.parentElement)||void 0===a?void 0:a.getAttribute("style");if(i){const e=t.richMediaFormat||"unknown-format",a=(()=>{var e,t;try{if("timeOrigin"in window.performance)return null===(e=window.top)||void 0===e?void 0:e.performance.timeOrigin;if("timing"in window.performance)return null===(t=window.top)||void 0===t?void 0:t.performance.timing.navigationStart}catch(e){return R.Logger.error("Could not get page start timestamp",e),0}})();return(0,M.hashString)(`${a}${e}${i}`)}}return null};t.instantiateCreativeMode=(e,a,i,r)=>{const o=p.creativeStore.get("entities");"production"!==L.Environment.PRODUCTION&&(0,w.listenToReferrer)(),(0,I.dispatchApiData)(p.apiStore.get("apiFeed"),"event",[{phase:h.AMTCustomEventPhase.AMT_LOADED_TO_CREATIVE_MODE}]);const{richMediaFormat:s=null,richMediaPart:l=null}=a||{},_=(0,g.getTopMostAccessibleParentIframeWindow)(window),m=(0,c.getAdTarget)(_),b=(0,u.hasPageAccess)(_),M=(0,c.getPageAccessType)(window,_),C=A.Mode.CREATIVE;_.__amt_mode__=C;const D={target:m,format:(0,S.getAdFormat)({richMediaFormat:s,target:m,window:_}),pageAccess:b,topMostAccessibleFrameWindow:_,pageAccessType:M,part:l},V=(0,c.getAd)(a,D,null==i?void 0:i.code);if(y.globalEventBus.publish("debug:impressionId",{impressionId:V.id}),window.addEventListener("pagehide",()=>{y.globalEventBus.publish("ad:removed",{adId:V.id})}),window.addEventListener("visibilitychange",()=>{"hidden"!==document.visibilityState||p.apiStore.get("disableEventDispatch")||((0,O.dispatchLatestSyntheticIntersectionEvents)(),(0,O.cleanUpEventTimelines)())}),(0,E.addCreativeIdAttributeToAdTarget)(V.target,V.id),"string"==typeof(null==o?void 0:o.campaignId)&&!(0,P.isValidCampaign)(o.campaignId))return void R.Logger.warn("Invalid campaign detected. Exiting.",{campaignId:o.campaignId});const U=(0,T.getSampleRateForCreative)(n.config.adSampling.creativeMode,o);if(!(0,T.applySampling)(U))return;if(e.custom){const t=e.custom[v.ADVERTISER_ENTITY_KEY];t&&p.creativeStore.set("advertiserExtCode",t)}const F=(new Date).getTime();p.adStore.actions.insertAds([V]),a&&p.creativeStore.set("richMediaParams",a);const B=N(V,a);(0,d.captureAdLoadEvent)("amt:load:creative",{ad:V,entities:o,instantiationTimestamp:F,requiredMacros:e.common,customMacroValues:e.custom,sampleRate:U,dataVendor:r,tag:i,richMediaParams:a,groupKey:B}),(0,I.dispatchApiData)(p.apiStore.get("apiFeed"),"event",[Object.assign({phase:h.AMTCustomEventPhase.AMT_INITIALISE_ADS},(0,I.getCustomEventDetailByAd)(V))]),V.waitForIframeReady(()=>{(0,I.dispatchApiData)(p.apiStore.get("apiFeed"),"event",[Object.assign({phase:h.AMTCustomEventPhase.AMT_INITIALISE_EVENT_COLLECTION},(0,I.getCustomEventDetailByAd)(V))]),(0,t.instantiateEventCollection)(V,r)}),(0,f.pollForVpMetadata)(V)}},1101:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.instantiatePageMode=t.createMutationHandler=t.attachLoadedAds=t.initialiseDetectedAd=t.instantiateEventCollection=void 0;const i=a(4528),n=a(6289),r=a(3194),o=a(5123),s=a(6893),d=a(5990),l=a(3314),c=a(8679),u=a(9402),g=a(7240),p=a(4814),E=a(9791),v=a(6376),_=a(5751),T=a(6581),m=a(1763),A=a(395),b=a(8454),I=a(111),h=a(9630),f=a(5887),S=a(7098),y=a(6001);t.instantiateEventCollection=(e,t)=>{(0,v.initialiseAdSession)(e);const a=[e];(0,c.captureIntersectionObserverEvents)(e,m.Mode.PAGE),(0,_.captureDataVendorFeatureEvents)(t),n.featureConfig.imageCapture.enabled&&(0,u.captureImages)(a)};t.initialiseDetectedAd=(e,a,n,r,o)=>{const l=(0,E.getCreativeModeAttributes)(e.target);if((0,I.isApiStreamEnabled)("production")){const t=new MutationObserver((0,s.createAdSwapMutationHandler)(a,n,r,o));t.observe(e.target,s.AD_SWAP_MUTATION_OBSERVER_CONFIG),window.setTimeout(()=>{t.disconnect()},6e4)}const c=(0,I.isValidInternalDataVendor)(o);if(!(r||l&&l.id||c||(0,p.applySampling)(i.config.adSampling.pageMode)))return;g.adStore.actions.insertAds([e]);const u=c?p.INTERNAL_DATA_VENDOR_SAMPLE_RATE:(0,p.getSampleRateForPage)(i.config.adSampling.pageMode);(0,d.captureAdLoadEvent)("amt:load:page",{ad:e,entities:g.creativeStore.get("entities"),instantiationTimestamp:a,creativeModeAttributes:l,customMacroValues:n.custom,sampleRate:u,dataVendor:o,tag:r}),(0,A.dispatchApiData)(g.apiStore.get("apiFeed"),"event",[Object.assign({phase:b.AMTCustomEventPhase.AMT_INITIALISE_ADS},(0,A.getCustomEventDetailByAd)(e))]),e.waitForIframeReady(()=>{(0,A.dispatchApiData)(g.apiStore.get("apiFeed"),"event",[Object.assign({phase:b.AMTCustomEventPhase.AMT_INITIALISE_EVENT_COLLECTION},(0,A.getCustomEventDetailByAd)(e))]),(0,t.instantiateEventCollection)(e,o)}),f.globalEventBus.publish("ad:detected",{adId:e.id})};t.attachLoadedAds=(e,a,i,n,r)=>{const s={pageAccess:!0,topMostAccessibleFrameWindow:window,pageAccessType:T.PageAccessType.FULL},d=(0,o.constructDisplayAds)(e,s);S.Logger.log(`Attaching ${d.length} new ad targets`),d.forEach(e=>{(0,t.initialiseDetectedAd)(e,a,i,n,r),(0,h.pollForVpMetadata)(e)})};t.createMutationHandler=(e,a,i,n)=>o=>{o.forEach(o=>{if("childList"===o.type){const s=(0,r.filterIframes)(o.addedNodes),d=(0,r.filterIframesForSupportedAds)(s);d.length&&(0,t.attachLoadedAds)(d,e,a,i,n);const l=(0,r.filterIframes)(o.removedNodes);if(l.length){const e=g.adStore.get("detectedAds");for(const t of l){const a=e.find(e=>e.target===t);a&&f.globalEventBus.publish("ad:removed",{adId:a.id})}}}})};t.instantiatePageMode=(e,a,i)=>{(0,A.dispatchApiData)(g.apiStore.get("apiFeed"),"event",[{phase:b.AMTCustomEventPhase.AMT_LOADED_TO_PAGE_MODE}]),window.__amt_mode__=m.Mode.PAGE;const n=(new Date).getTime(),d=document.getElementsByTagName("body")[0];new MutationObserver((0,t.createMutationHandler)(n,e,a,i)).observe(d,s.DEFAULT_MUTATION_OBSERVER_CONFIG),(0,l.initialiseBrowsingFeatures)(m.Mode.PAGE),window.addEventListener("visibilitychange",()=>{"hidden"!==document.visibilityState||g.apiStore.get("disableEventDispatch")||((0,y.dispatchLatestSyntheticIntersectionEvents)(),(0,y.cleanUpEventTimelines)())});const c=(0,r.findSupportedAds)(window),u={pageAccess:!0,topMostAccessibleFrameWindow:window,pageAccessType:T.PageAccessType.FULL},p=(0,o.constructDisplayAds)(c,u);0!==p.length&&p.forEach(r=>{(0,t.initialiseDetectedAd)(r,n,e,a,i),(0,h.pollForVpMetadata)(r)})}},4216:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GazeDebugController=void 0;t.GazeDebugController=class{constructor(e){this.init=()=>{this.eventBus.subscribe("ad:removed",this.onAdRemoved),this.eventBus.subscribe("debug:toggle-gaze",this.onToggleGaze)},this.onToggleGaze=e=>{e.isEnabled?(this.eventBus.subscribe("ad:rectangle-change",this.onAdRectangleChange),this.eventBus.subscribe("vp:gaze",this.onGaze),this.eventBus.subscribe("ad:in-gaze-status",this.onAdInGazeStatus),document.body.insertBefore(this.gazeDebugElement,document.querySelector("amt-debug-window"))):(this.eventBus.unsubscribe("ad:rectangle-change",this.onAdRectangleChange),this.eventBus.unsubscribe("vp:gaze",this.onGaze),this.eventBus.unsubscribe("ad:in-gaze-status",this.onAdInGazeStatus),document.body.removeChild(this.gazeDebugElement))},this.onAdRectangleChange=e=>{this.gazeDebugElement.updateAdRect(e.adId,e.rect)},this.onGaze=e=>{const{x:t=-100,y:a=-100}=e;this.gazeDebugElement.setGazeCoordinates({x:t,y:a})},this.onAdInGazeStatus=e=>{const{adId:t,inGaze:a}=e;this.gazeDebugElement.highlightAdOutline(t,a)},this.onAdRemoved=e=>{this.gazeDebugElement.removeAd(e.adId)},this.eventBus=e.eventBus,this.gazeDebugElement=e.gazeDebugElement}}},4170:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GazeDebugElement=void 0;class a extends HTMLElement{constructor(){super(),this.adOutlines={};const e=this.attachShadow({mode:"open"}),t=document.createElement("style");t.innerText=`\n    .wrapper {\n        /* Prevent clicks in this element */\n        pointer-events: none;\n        z-index: ${Number.MAX_SAFE_INTEGER};\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100vw;\n        height: 100vh;\n    }\n    \n    .gaze-dot {\n        width: 10px;\n        height: 10px;\n        background-color: red;\n        border: 3px solid black;\n        border-radius: 50px;\n        position: fixed;\n        top: 0;\n        left: 0;\n        transform: translate(-100px, -100px);\n    }    \n    \n    .outline {\n        position: fixed;\n        box-shadow: inset 0 0 0 10px red;\n    }\n    \n    .outline-in-gaze {\n        box-shadow: inset 0 0 0 10px lime;    \n    }\n`,e.innerHTML='<div class="wrapper">\n<div class="gaze-dot"></div>\n</div>',e.appendChild(t),this.wrapper=e.querySelector(".wrapper"),this.gazeDot=e.querySelector(".gaze-dot")}setGazeCoordinates(e){const{x:t,y:a}=e;this.gazeDot.style.transform=`translate(${t-5}px, ${a-5}px)`}highlightAdOutline(e,t){this.registerAd(e),t?this.adOutlines[e].el.classList.add("outline-in-gaze"):this.adOutlines[e].el.classList.remove("outline-in-gaze")}registerAd(e){var t;if(!this.adOutlines[e]){const a=document.createElement("div");a.innerText=null!==(t=e.split("-").shift())&&void 0!==t?t:"unknown-id",a.id=e,a.classList.add("outline"),this.adOutlines[e]={el:a},this.wrapper.insertBefore(a,this.gazeDot)}}removeAd(e){const t=this.adOutlines[e];t&&(this.wrapper.removeChild(t.el),delete this.adOutlines[e])}updateAdRect(e,t){this.registerAd(e);const a=this.adOutlines[e];a&&(a.rect=t,a.el.style.width=t.width+"px",a.el.style.height=t.height+"px",a.el.style.top=t.y+"px",a.el.style.left=t.x+"px")}}t.GazeDebugElement=a,customElements.get("amt-display-gaze-debug")||customElements.define("amt-display-gaze-debug",a)},4032:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.installGazeDebug=void 0;const i=a(4216),n=a(5887),r=a(4170),o=e=>{const{isEnabled:t}=e.detail;n.globalEventBus.publish("debug:toggle-gaze",{isEnabled:t})};t.installGazeDebug=e=>{var t,a;if("page"===e){window.addEventListener("toggle-amt-gaze-debug",o);const e=new r.GazeDebugElement;new i.GazeDebugController({eventBus:n.globalEventBus,gazeDebugElement:e}).init();const t=e=>{const{data:t}=e;var a;"creative-event"===(a=t).action&&["ad:detected","ad:removed","ad:rectangle-change","ad:in-gaze-status"].includes(a.eventName)&&n.globalEventBus.publish(t.eventName,t.payload)};window.addEventListener("message",t)}else if("creative"===e){const e=null!==(a=null===(t=window.top)||void 0===t?void 0:t.location.origin)&&void 0!==a?a:window.location.origin,i=(t,a)=>{var i;return null===(i=window.top)||void 0===i?void 0:i.postMessage({action:"creative-event",eventName:t,payload:a},e)};n.globalEventBus.subscribe("ad:detected",e=>i("ad:detected",e)),n.globalEventBus.subscribe("ad:removed",e=>i("ad:removed",e)),n.globalEventBus.subscribe("ad:rectangle-change",e=>i("ad:rectangle-change",e)),n.globalEventBus.subscribe("ad:in-gaze-status",e=>i("ad:in-gaze-status",e))}}},2943:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.installCreativeModeQaTools=t.installPageModeQaTools=void 0;const i=a(4032),n=a(1763),r=a(7098);t.installPageModeQaTools=()=>{r.Logger.info("INSTALLING PAGE MODE QA TOOLS"),(0,i.installGazeDebug)(n.Mode.PAGE)};t.installCreativeModeQaTools=()=>{r.Logger.info("INSTALLING CREATIVE MODE QA TOOLS"),(0,i.installGazeDebug)(n.Mode.CREATIVE)}},4816:function(e,t,a){var i=this&&this.__rest||function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(a[i[n]]=e[i[n]])}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.actions=void 0;const n=a(395),r=a(7240);t.actions={insertAds:({set:e})=>t=>{e("detectedAds",e=>[...e,...t]),(0,n.dispatchApiData)(r.apiStore.get("apiFeed"),"ad",t.map(e=>{const t=(0,n.getCustomEventDetailByAd)(e),a=i(t||{},[]);return delete a.id,Object.assign(Object.assign({},e),a)}))},replaceAd:({set:e})=>t=>{e("detectedAds",e=>{const a=e.findIndex(e=>e.id===t.id);return a>-1&&e.splice(a,1,t),e})},removeAd:({set:e})=>t=>{e("detectedAds",e=>e.filter(e=>e.id!==t.id))}}},28:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultValues=void 0,t.defaultValues={detectedAds:[]}},4794:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},394:function(e,t,a){var i=this&&this.__createBinding||(Object.create?function(e,t,a,i){void 0===i&&(i=a);var n=Object.getOwnPropertyDescriptor(t,a);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,i,n)}:function(e,t,a,i){void 0===i&&(i=a),e[i]=t[a]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&i(t,e,a);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(a(4816)),s=r(a(5542)),d=r(a(4794)),l=r(a(28));t.default=Object.assign(Object.assign(Object.assign(Object.assign({},o),s),d),l)},5542:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queries=void 0;t.queries={adsForZone:({get:e})=>t=>e("detectedAds").filter(e=>e.zone===t)}},2038:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.actions=void 0;const i=a(395),n=a(423),r=a(7240);t.actions={insertRawEvents:({set:e,get:t})=>a=>{e("rawEventTimeline",e=>[...e,...a]),(0,i.dispatchApiData)(t("apiFeed"),"event",a)},removeRawEvents:({set:e,get:t})=>a=>{const i=t("rawEventTimeline").slice(0,a);return e("rawEventTimeline",e=>[...e.slice(a)]),i},insertIntervalEvents:({set:e,get:t})=>a=>{const o=a.filter(e=>r.vpStore.get("adTargetAdSwapStatusMapping")[e.id]!==n.AdSwapStatusEnum.PAUSED);e("intervalEventTimeline",e=>[...e,...o]),(0,i.dispatchApiData)(t("apiFeed"),"event",a)},removeIntervalEvents:({set:e,get:t})=>a=>{const i=t("intervalEventTimeline").slice(0,a);return e("intervalEventTimeline",e=>[...e.slice(a)]),i},insertSyntheticEvents:({set:e,get:t})=>a=>{const o=a.filter(e=>r.vpStore.get("adTargetAdSwapStatusMapping")[e.id]!==n.AdSwapStatusEnum.PAUSED);e("syntheticEventTimeline",e=>[...e,...o]),(0,i.dispatchApiData)(t("apiFeed"),"event",a)},removeSyntheticEvents:({set:e,get:t})=>a=>{const i=t("syntheticEventTimeline").slice(0,a);return e("syntheticEventTimeline",e=>[...e.slice(a)]),i},insertStoredBatch:({set:e})=>t=>{e("storedBatch",e=>[...e,...t])},replaceEventInStoredBatch:({set:e})=>t=>{e("storedBatch",e=>{const a=e.findIndex(e=>e.id===t.id);return a>-1&&e.splice(a,1,t),e})},removeStoredBatch:({set:e,get:t})=>a=>{const i=t("storedBatch").slice(0,a);return e("storedBatch",e=>[...e.slice(a)]),i},setupVisionProjectApiStream:({set:e})=>()=>{e("apiFeed",i.setupApiStream&&(0,i.setupApiStream)())}}},887:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultValues=void 0,t.defaultValues={rawEventTimeline:[],intervalEventTimeline:[],syntheticEventTimeline:[],storedBatch:[],apiFeed:null,disableEventDispatch:!1}},5038:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3565:function(e,t,a){var i=this&&this.__createBinding||(Object.create?function(e,t,a,i){void 0===i&&(i=a);var n=Object.getOwnPropertyDescriptor(t,a);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,i,n)}:function(e,t,a,i){void 0===i&&(i=a),e[i]=t[a]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&i(t,e,a);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(a(2038)),s=r(a(2783)),d=r(a(5038)),l=r(a(887));t.default=Object.assign(Object.assign(Object.assign(Object.assign({},o),s),d),l)},2783:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queries=void 0,t.queries={}},5986:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.actions=void 0,t.actions={}},8874:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultValues=void 0,t.defaultValues={advertiserExtCode:null,tagSamplingAttributes:null,richMediaParams:null,entities:null,macros:{common:{referrer:null},custom:{}},tagAttributes:{code:null,label:null}}},7427:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3898:function(e,t,a){var i=this&&this.__createBinding||(Object.create?function(e,t,a,i){void 0===i&&(i=a);var n=Object.getOwnPropertyDescriptor(t,a);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,i,n)}:function(e,t,a,i){void 0===i&&(i=a),e[i]=t[a]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&i(t,e,a);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(a(5986)),s=r(a(6060)),d=r(a(7427)),l=r(a(8874));t.default=Object.assign(Object.assign(Object.assign(Object.assign({},o),s),d),l)},6060:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queries=void 0,t.queries={}},6298:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.actions=void 0;t.actions={insertBrowsingDynamicsIntervals:({set:e})=>t=>{e("browsingDynamicsIntervals",e=>[...e,...t])},insertSyntheticEventLookup:({set:e})=>(t,a)=>{e("syntheticEventLookup",e=>(e[t]=Object.assign(Object.assign({},e[t]),a),e))},insertIntersectionObserver:({set:e})=>(t,a)=>{e("intersectionObservers",e=>{const i=e[t.id];return e[t.id]=i?i.concat(a):[a],e})},removeIntersectionObserver:({set:e})=>t=>{e("intersectionObservers",e=>{const a=e[t.id];return null==a||a.forEach(e=>e.disconnect()),delete e[t.id],e})},removeBrowsingDynamicsInterval:({set:e})=>t=>{e("browsingDynamicsIntervals",e=>e.filter(e=>e.id!==t.id))}}},4677:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultValues=void 0,t.defaultValues={browsingDynamicsIntervals:[],syntheticEventLookup:{intersection:{}},intersectionObservers:{}}},1132:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1281:function(e,t,a){var i=this&&this.__createBinding||(Object.create?function(e,t,a,i){void 0===i&&(i=a);var n=Object.getOwnPropertyDescriptor(t,a);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,i,n)}:function(e,t,a,i){void 0===i&&(i=a),e[i]=t[a]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&i(t,e,a);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(a(6298)),s=r(a(2230)),d=r(a(1132)),l=r(a(4677));t.default=Object.assign(Object.assign(Object.assign(Object.assign({},o),s),d),l)},2230:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queries=void 0;t.queries={intersectionObservers:({get:e})=>t=>e("intersectionObservers")[t.id]||[],browsingDynamicsIntervals:({get:e})=>()=>e("browsingDynamicsIntervals").map(e=>Object.assign({},e))}},1499:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.actions=void 0,t.actions={}},5213:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultValues=void 0;const i=a(9476);t.defaultValues={instanceId:(0,i.uuidv4)(),script:{element:void 0,srcString:null,queryParams:new URLSearchParams,attributes:{},pathname:null}}},1837:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6688:function(e,t,a){var i=this&&this.__createBinding||(Object.create?function(e,t,a,i){void 0===i&&(i=a);var n=Object.getOwnPropertyDescriptor(t,a);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,i,n)}:function(e,t,a,i){void 0===i&&(i=a),e[i]=t[a]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&i(t,e,a);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(a(1499)),s=r(a(8750)),d=r(a(1837)),l=r(a(5213));t.default=Object.assign(Object.assign(Object.assign(Object.assign({},o),s),d),l)},8750:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queries=void 0,t.queries={}},9852:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.actions=void 0;t.actions={setAdTargetAdSwapStatus:e=>(t,a)=>{e.set("adTargetAdSwapStatusMapping",e=>(e[t]=a,e))}}},267:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultValues=void 0,t.defaultValues={visionProjectClient:null,adTargetAdSwapStatusMapping:{}}},1570:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8036:function(e,t,a){var i=this&&this.__createBinding||(Object.create?function(e,t,a,i){void 0===i&&(i=a);var n=Object.getOwnPropertyDescriptor(t,a);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,i,n)}:function(e,t,a,i){void 0===i&&(i=a),e[i]=t[a]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&i(t,e,a);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(a(9852)),s=r(a(5518)),d=r(a(1570)),l=r(a(267));t.default=Object.assign(Object.assign(Object.assign(Object.assign({},o),s),d),l)},5518:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queries=void 0,t.queries={}},749:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.actions=void 0,t.actions={}},1109:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultValues=void 0,t.defaultValues={currentUrl:window.location.href,api:null,video:null,isAdMuted:!1,adState:null,currentVideoInViewPercentage:null,videoViewableStatus:null,isActiveTab:!0,videoEventCaptureConfig:null,isMiniPlayerTransition:!1,miniPlayer:null,currentPlayerMode:null,videoDuration:null}},9681:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6761:function(e,t,a){var i=this&&this.__createBinding||(Object.create?function(e,t,a,i){void 0===i&&(i=a);var n=Object.getOwnPropertyDescriptor(t,a);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,i,n)}:function(e,t,a,i){void 0===i&&(i=a),e[i]=t[a]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&i(t,e,a);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(a(749)),s=r(a(1018)),d=r(a(9681)),l=r(a(1109));t.default=Object.assign(Object.assign(Object.assign(Object.assign({},o),s),d),l)},1018:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queries=void 0,t.queries={}},6136:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.storeFactory=void 0;const n=a(1451),r=a(4259),o=a(3635),s=i(a(394)),d=i(a(3565)),l=i(a(3898)),c=i(a(1281)),u=i(a(6688)),g=i(a(8036)),p=i(a(6761)),E=e=>{const t=new r.Store(e.defaultValues);return()=>(0,o.createStoreAccessor)(t)(Object.assign({},e))};t.storeFactory=new n.Factory({constructors:{api:E(d.default),ad:E(s.default),visionProject:E(g.default),youtube:E(p.default),system:E(u.default),creative:E(l.default),measurement:E(c.default)}})},6581:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AdClassType=t.ReadyState=t.EventListenerType=t.SuperSkinV2Part=t.Zone=t.PageAccessType=void 0,function(e){e.FULL="full",e.PARTIAL="partial",e.RESTRICTED="restricted"}(t.PageAccessType||(t.PageAccessType={})),function(e){e.TARGET_ZONE="target_zone",e.ZONE_2="zone_2"}(t.Zone||(t.Zone={})),function(e){e.HERO="hero",e.BANNER="banner"}(t.SuperSkinV2Part||(t.SuperSkinV2Part={})),function(e){e.LOAD="load"}(t.EventListenerType||(t.EventListenerType={})),function(e){e.LOADING="loading",e.INTERACTIVE="interactive",e.COMPLETE="complete"}(t.ReadyState||(t.ReadyState={})),function(e){e.DISPLAY="display",e.YOUTUBE="youTube",e.GUMGUM_IN_SCREEN_FRAME="gumgum:in-screen-frame:in-screen-frame",e.GUMGUM_IN_SCREEN_FRAME_NEW="71-5aa35650:35",e.JP_MOBILE_SCROLLER_MAIN="jp:is:main",e.JP_MOBILE_SCROLLER_MAIN_NEW_NO_PART="71-5aa35650:46",e.JP_MOBILE_SCROLLER_MAIN_NEW="71-5aa35650:46:main",e.JP_MOBILE_SKIN_MAIN="jp:mt:main",e.JP_MOBILE_SKIN_MAIN_NEW="71-5aa35650:59:main",e.CELTRA_INTERSCROLLER="celtra:interscroller:main",e.CELTRA_INTERSCROLLER_V1="celtra:v1",e.CELTRA_INTERSCROLLER_V2="celtra:v2",e.CELTRA_INTERSCROLLER_V3="celtra:v3",e.PXYZ_VELOCITY="playgroundxyz:velocity:ad"}(t.AdClassType||(t.AdClassType={}))},423:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AdSwapNotificationEnum=t.AdSwapStatusEnum=void 0,function(e){e.PAUSED="PAUSED",e.RESUMED="RESUMED"}(t.AdSwapStatusEnum||(t.AdSwapStatusEnum={})),function(e){e.PAUSE="adsw-disable-amt-ongaze-events",e.RESUME="adsw-enable-amt-ongaze-events"}(t.AdSwapNotificationEnum||(t.AdSwapNotificationEnum={}))},8454:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XMLHttpRequestReadyState=t.LocationRelativeToViewport=t.AMTCustomEventPhase=void 0,function(e){e.AMT_ADDED="AMT added to the page",e.AMT_LOADED_TO_PAGE_MODE="AMT loaded (page mode)",e.AMT_LOADED_TO_CREATIVE_MODE="AMT loaded (creative mode)",e.AMT_LOADED_TO_YOUTUBE_MODE="AMT loaded (youtube mode)",e.AMT_GLOBAL_HANDLER_INITIALISED="AMT global handler initialised",e.AMT_INTERNAL_HANDLER_ADDED="AMT internal handler added",e.AMT_GAZE_DATA_RECEIVED="AMT gaze data received",e.AMT_INITIALISE_ADS="AMT initialise ads",e.AMT_INITIALISE_EVENT_COLLECTION="AMT initalise event collection",e.AMT_CAPTURE_EVENTS="AMT capture events"}(t.AMTCustomEventPhase||(t.AMTCustomEventPhase={})),function(e){e.ABOVE="above",e.WITHIN="within",e.BELOW="below"}(t.LocationRelativeToViewport||(t.LocationRelativeToViewport={})),function(e){e[e.UNSENT=0]="UNSENT",e[e.OPENED=1]="OPENED",e[e.HEADERS_RECEIVED=2]="HEADERS_RECEIVED",e[e.LOADING=3]="LOADING",e[e.DONE=4]="DONE"}(t.XMLHttpRequestReadyState||(t.XMLHttpRequestReadyState={}))},4283:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Environment=void 0,function(e){e.PRODUCTION="production",e.STAGING="staging",e.DEVELOPMENT="development",e.TESTING="testing"}(t.Environment||(t.Environment={}))},2756:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DataVendorFeature=t.DataVendorName=void 0,function(e){e.VISION_PROJECT="vision-project"}(t.DataVendorName||(t.DataVendorName={})),function(e){e.GAZE="gaze"}(t.DataVendorFeature||(t.DataVendorFeature={}))},4870:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EndReason=void 0,function(e){e.AD_SWAP="AD_SWAP"}(t.EndReason||(t.EndReason={}))},4747:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.busFactory=void 0;const i=a(1451),n=a(835);t.busFactory=new i.Factory({constructors:{"youtube-mobile":()=>new n.EventBus,global:()=>new n.EventBus}})},9666:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SyntheticEventTypes=void 0,function(e){e.INTERSECTION="intersection"}(t.SyntheticEventTypes||(t.SyntheticEventTypes={}))},7603:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LOG_LEVEL=void 0,function(e){e.DEBUG="debug",e.INFO="info",e.LOG="log",e.WARN="warn",e.ERROR="error"}(t.LOG_LEVEL||(t.LOG_LEVEL={}))},6332:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventType=void 0,function(e){e.LOAD_EVENT="LOAD_EVENT",e.MEASURE_EVENT="MEASURE_EVENT",e.OFFLINE_EVENT="OFFLINE_EVENT",e.PAGE_EVENT="PAGE_EVENT",e.END_EVENT="END_EVENT",e.TRIGGERED_EVENT="TRIGGERED_EVENT",e.VIEWABLE_EVENT="VIEWABLE_EVENT",e.VIDEO_PROGRESS_EVENT="VIDEO_PROGRESS_EVENT",e.VISION_PROJECT_METADATA_EVENT="VISION_PROJECT_METADATA_EVENT"}(t.EventType||(t.EventType={}))},1763:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Mode=void 0,function(e){e.CREATIVE="creative",e.PAGE="page",e.YOUTUBE="youtube"}(t.Mode||(t.Mode={}))},8842:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ReferrerOrigin=void 0,function(e){e.SRC_SCRIPT="SRC_SCRIPT",e.DCIM_ATTRIBUTE="DCIM_ATTRIBUTE",e.DCIM_IFRAME="DCIM_IFRAME",e.WINDOW_HREF="WINDOW_HREF",e.WINDOW_REFERRER="WINDOW_REFERRER",e.WINDOW_URL="WINDOW_URL",e.WINDOW_BASE_URI="WINDOW_BASE_URI"}(t.ReferrerOrigin||(t.ReferrerOrigin={}))},4994:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RichMediaAttributes=t.RichMediaVendor=void 0,function(e){e.PLAYGROUNDXYZ="playgroundxyz",e.GUMGUM="gumgum",e.JUST_PREMIUM="jp"}(t.RichMediaVendor||(t.RichMediaVendor={})),function(e){e.RICH_MEDIA_FORMAT="richMediaFormat",e.RICH_MEDIA_PART="richMediaPart",e.RICH_MEDIA_VENDOR="richMediaVendor"}(t.RichMediaAttributes||(t.RichMediaAttributes={}))},7964:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Trigger=void 0,function(e){e.FULLSCREEN_ON="FULLSCREEN_ON",e.FULLSCREEN_OFF="FULLSCREEN_OFF",e.MUTE="MUTE",e.UNMUTE="UNMUTE",e.CLICKTHROUGH="CLICKTHROUGH",e.PLAY="PLAY",e.PAUSE="PAUSE",e.SKIP="SKIP",e.ABANDON="ABANDON"}(t.Trigger||(t.Trigger={}))},2026:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressCheckpoint=void 0,function(e){e[e.PLAY_25=25]="PLAY_25",e[e.PLAY_50=50]="PLAY_50",e[e.PLAY_75=75]="PLAY_75",e[e.PLAY_100=100]="PLAY_100"}(t.ProgressCheckpoint||(t.ProgressCheckpoint={}))},7079:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ViewportCoverageInterval=void 0,function(e){e.INTERVAL_0="interval_0_24",e.INTERVAL_25="interval_25_49",e.INTERVAL_50="interval_50_74",e.INTERVAL_75="interval_75_99",e.INTERVAL_100="interval_100"}(t.ViewportCoverageInterval||(t.ViewportCoverageInterval={}))},3426:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PLAYER_STATE=t.YOUTUBE_PLAYER_MODE=t.YOUTUBE_COMPOSITE_CLASS=t.YOUTUBE_AD_STATE=t.YOUTUBE_POSITION_IN_CONTENT=t.YOUTUBE_IN_STREAM_AD_TYPE=void 0,function(e){e.BUMPER="bumper",e.SKIPPABLE="skippable",e.NONSKIPPABLE="non-skippable"}(t.YOUTUBE_IN_STREAM_AD_TYPE||(t.YOUTUBE_IN_STREAM_AD_TYPE={})),function(e){e.PRE_ROLL="pre-roll",e.MID_ROLL="mid-roll",e.POST_ROLL="post-roll"}(t.YOUTUBE_POSITION_IN_CONTENT||(t.YOUTUBE_POSITION_IN_CONTENT={})),function(e){e[e.UNSTARTED=-1]="UNSTARTED",e[e.ENDED=0]="ENDED",e[e.PLAYING=1]="PLAYING",e[e.PAUSED=2]="PAUSED",e[e.BUFFERING=3]="BUFFERING",e[e.VIDEO_CUED=5]="VIDEO_CUED"}(t.YOUTUBE_AD_STATE||(t.YOUTUBE_AD_STATE={})),function(e){e.AD_SKIP_BUTTON_ICON="ytp-ad-skip-button_ytp-ad-skip-button-icon",e.AD_SKIP_BUTTON_TEXT="ytp-ad-skip-button_ytp-ad-skip-button-text",e.AD_SKIP_BUTTON="ytp-ad-skip-button-container_ytp-ad-skip-button",e.AD_BUTTON_TEXT="ytp-flyout-cta-action-button_ytp-ad-button-text",e.FLYOUT_HEADLINE="ytp-flyout-cta-headline-container_ytp-flyout-cta-headline",e.FLYOUT_DESCRIPTION="ytp-flyout-cta-description-container_ytp-flyout-cta-description",e.FLYOUT_ACTION_BUTTON_CONTAINER="ytp-flyout-cta-body_ytp-flyout-cta-action-button-container",e.FLYOUT_ACTION_BUTTON="ytp-flyout-cta-action-button-container_ytp-flyout-cta-action-button",e.FLYOUT_ICON="ytp-flyout-cta-icon-container_ytp-flyout-cta-icon",e.FLYOUT_TEXT_CONTAINER="ytp-flyout-cta-body_ytp-flyout-cta-text-container",e.VISIT_ADVERTISER_BUTTON="ytp-ad-player-overlay-instream-info_ytp-ad-visit-advertiser-button",e.AD_BUTTON_ICON="ytp-ad-visit-advertiser-button_ytp-ad-button-icon",e.AD_NEXT_BUTTON="ytp-left-controls_ytp-next-button",e.NORMAL_TO_MINI_PLAYER="ytp-right-controls_ytp-miniplayer-button",e.MINI_PLAYER_TO_NORMAL="_miniplayer-title",e.MINI_PLAYER_TO_NORMAL_DEEP="miniplayer-title_",e.MINI_PLAYER_CLOSE_BUTTON="ytp-miniplayer-buttons_ytp-miniplayer-close-button"}(t.YOUTUBE_COMPOSITE_CLASS||(t.YOUTUBE_COMPOSITE_CLASS={})),function(e){e.DEFAULT="default",e.FULLSCREEN="fullscreen",e.THEATER="theater",e.MINI_PLAYER="mini-player"}(t.YOUTUBE_PLAYER_MODE||(t.YOUTUBE_PLAYER_MODE={})),function(e){e[e.UNSTARTED=-1]="UNSTARTED",e[e.ENDED=0]="ENDED",e[e.PLAYING=1]="PLAYING",e[e.PAUSED=2]="PAUSED",e[e.BUFFERING=3]="BUFFERING",e[e.QUEUED=5]="QUEUED"}(t.PLAYER_STATE||(t.PLAYER_STATE={}))},5123:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAdTarget=t.getPageAccessType=t.constructDisplayAds=t.getAd=void 0;const i=a(6581),n=a(6245),r=a(4616),o=a(3543),s=["71-5aa35650"];t.getAd=(e,t,a)=>{try{const{richMediaVendor:i,richMediaFormat:n,richMediaPart:r}=e||{};if(a&&s.includes(a))try{const e=[a,n,r].filter(Boolean).join(":");return o.adFactory.create(e,t)}catch(e){}const d=[i,n,r].filter(Boolean).join(":");return o.adFactory.create(d,t)}catch(e){return o.adFactory.create(i.AdClassType.DISPLAY,t)}};t.constructDisplayAds=(e,t)=>e.map(e=>{const a=(0,r.getAdFormat)({richMediaFormat:null,target:e,window:t.topMostAccessibleFrameWindow}),n=Object.assign({target:e,format:a},t);return o.adFactory.create(i.AdClassType.DISPLAY,n)});t.getPageAccessType=(e,t)=>(0,n.hasPageAccess)(t)?i.PageAccessType.FULL:(0,n.hasPageAccess)(e)&&t!==e?i.PageAccessType.PARTIAL:i.PageAccessType.RESTRICTED;t.getAdTarget=e=>e.frameElement?e.frameElement:e.document.body},3543:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adFactory=void 0;const i=a(6581),n=a(1451),r=a(739),o=a(9788),s=a(9476),d=a(391),l=a(2001),c=a(9540),u=a(107),g=a(6042),p=e=>{const t=(0,d.getAdInitialZone)(e);return new l.InScreenFrame(Object.assign(Object.assign({},e),{id:(0,s.uuidv4)(),zone:t}))},E=e=>{const t=(0,d.getAdInitialZone)(e);return new c.JustPremiumFixedAd(Object.assign(Object.assign({},e),{id:(0,s.uuidv4)(),zone:t}))},v=e=>{const t=(0,d.getAdInitialZone)(e);return new u.Interscroller(Object.assign(Object.assign({},e),{id:(0,s.uuidv4)(),zone:t}))},_={[i.AdClassType.DISPLAY]:e=>{const t=(0,s.uuidv4)(),a=(0,d.getAdInitialZone)(e);return new r.DisplayAd(Object.assign(Object.assign({},e),{zone:a,id:t}))},[i.AdClassType.YOUTUBE]:e=>{const t=(0,s.uuidv4)();return new o.YouTubeAd(Object.assign(Object.assign({},e),{id:t}))},[i.AdClassType.GUMGUM_IN_SCREEN_FRAME]:p,[i.AdClassType.GUMGUM_IN_SCREEN_FRAME_NEW]:p,[i.AdClassType.JP_MOBILE_SCROLLER_MAIN]:E,[i.AdClassType.JP_MOBILE_SCROLLER_MAIN_NEW_NO_PART]:E,[i.AdClassType.JP_MOBILE_SCROLLER_MAIN_NEW]:E,[i.AdClassType.JP_MOBILE_SKIN_MAIN]:E,[i.AdClassType.JP_MOBILE_SKIN_MAIN_NEW]:E,[i.AdClassType.CELTRA_INTERSCROLLER]:v,[i.AdClassType.CELTRA_INTERSCROLLER_V1]:v,[i.AdClassType.CELTRA_INTERSCROLLER_V2]:v,[i.AdClassType.CELTRA_INTERSCROLLER_V3]:v,[i.AdClassType.PXYZ_VELOCITY]:e=>{const t=(0,d.getAdInitialZone)(e);return new g.VelocityAd(Object.assign(Object.assign({},e),{id:(0,s.uuidv4)(),zone:t}))}};t.adFactory=new n.Factory({constructors:_})},8075:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseAd=void 0;const i=a(6581),n=a(1763),r=a(7098),o=a(3977);t.BaseAd=class{constructor(e){var t;this.format=null,this.part=null,this.getAdDimensions=()=>(this.adRect=this.target.getBoundingClientRect(),{height:this.adRect.height,width:this.adRect.width}),this.id=e.id,this.target=e.target,this.format=e.format,this.pageAccess=e.pageAccess,this.topMostAccessibleFrameWindow=e.topMostAccessibleFrameWindow,this.pageAccessType=e.pageAccessType,this.part=null!==(t=e.part)&&void 0!==t?t:null,this.adRect=e.target.getBoundingClientRect(),"none"===getComputedStyle(this.target).pointerEvents&&(this.target.style.pointerEvents="auto")}isInGaze(e){var t;const{x:a,y:i}=e;if(void 0===a||void 0===i)return!1;if(this.adRect=this.target.getBoundingClientRect(),!o.MathUtils.isIntersecting(e,this.adRect))return!1;const n=null===(t=window.top)||void 0===t?void 0:t.document.elementFromPoint(a,i);return!n||n===this.target}waitForIframeReady(e,t){var a;const o=null!=t?t:this.target;return o.ownerDocument?(r.Logger.log("Ad target state: "+o.ownerDocument.readyState),o.ownerDocument.readyState===i.ReadyState.COMPLETE||(null===(a=o.contentDocument)||void 0===a?void 0:a.readyState)===i.ReadyState.COMPLETE?e():void([i.ReadyState.LOADING,i.ReadyState.INTERACTIVE].includes(o.ownerDocument.readyState)&&o.addEventListener(i.EventListenerType.LOAD,()=>e(),{capture:this.topMostAccessibleFrameWindow.__amt_mode__===n.Mode.CREATIVE,once:!0}))):e()}isAdTargetValid(){const e=this.target.getBoundingClientRect();return e.width>0&&e.height>0&&e.top!==e.bottom&&e.left!==e.right}}},107:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Interscroller=void 0;const i=a(7098),n=a(8367);class r extends n.InternalTargetAd{constructor(e){super(e),this.getInternalAdTarget=()=>{try{const e=this.topMostAccessibleFrameWindow.parent.document.querySelector(".celtra-clipper");return e||(i.Logger.error.withScope("celtra",'Target element not found using query selector ".celtra-clipper"'),this.target)}catch(e){return i.Logger.error.withScope("celtra","Error when accessing the ad frame's parent div element with class .celtra-clipper",e),this.target}},this.target=this.getInternalAdTarget()}}t.Interscroller=r},739:function(e,t,a){var i=this&&this.__rest||function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(a[i[n]]=e[i[n]])}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.DisplayAd=void 0;const n=a(8075);class r extends n.BaseAd{constructor(e){const{zone:t}=e;super(i(e,["zone"])),this.getAdDimensions=()=>{if("IFRAME"===this.target.tagName&&this.pageAccess){const e=this.target.getBoundingClientRect();return{height:Math.round(e.height)||this.target.offsetHeight||this.target.clientHeight||0,width:Math.round(e.width)||this.target.offsetWidth||this.target.clientWidth||0}}return{height:this.topMostAccessibleFrameWindow.innerHeight||0,width:this.topMostAccessibleFrameWindow.innerWidth||0}},this.zone=t}isAdTargetValid(){return"IFRAME"===this.target.tagName&&super.isAdTargetValid()}}t.DisplayAd=r},2001:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InScreenFrame=void 0;const i=a(739),n=a(3977);class r extends i.DisplayAd{constructor(e){super(e),this.isExpanded=!1,this.calculateHotspots=()=>[new DOMRect(0,0,window.innerWidth,60),new DOMRect(0,0,60,window.innerHeight),new DOMRect(window.innerWidth-60,0,60,window.innerHeight),new DOMRect(0,window.innerHeight-100,window.innerWidth,100)];this.resizeObserver=new ResizeObserver(e=>{const t=e[0],{height:a}=t.contentRect;this.isExpanded=100!==a}),this.resizeObserver.observe(this.target)}isInGaze(e){if(this.isExpanded){if("number"!=typeof e.x||"number"!=typeof e.y)return!1;this.adRect=this.target.getBoundingClientRect();return this.calculateHotspots().some(t=>n.MathUtils.isIntersecting(e,t))}return super.isInGaze(e)}}t.InScreenFrame=r},8367:function(e,t,a){var i=this&&this.__rest||function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(a[i[n]]=e[i[n]])}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.InternalTargetAd=void 0;const n=a(3977),r=a(8075);class o extends r.BaseAd{constructor(e){const{zone:t}=e;super(i(e,["zone"])),this.zone=t,this.iframe=this.target}isInGaze(e){const{x:t,y:a}=e;return void 0!==t&&void 0!==a&&(this.adRect=this.target.getBoundingClientRect(),n.MathUtils.isIntersecting(e,this.adRect))}waitForIframeReady(e){this.resizeObserver=new ResizeObserver(()=>{var t;this.isAdTargetValid()&&(null===(t=this.resizeObserver)||void 0===t||t.disconnect(),super.waitForIframeReady(e,this.iframe))}),this.resizeObserver.observe(this.target)}}t.InternalTargetAd=o},9540:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JustPremiumFixedAd=void 0;const i=a(7098),n=a(8367),r=a(5887);class o extends n.InternalTargetAd{constructor(e){super(e),this.getInternalAdTarget=()=>{const e=e=>{const t="Could not access the ad frame's parent div element with class jpx-<code>-container. "+(null!=e?e:"");r.globalEventBus.publish("log:dispatch",{message:{scope:"just-premium",detail:t},level:"error"}),i.Logger.error.withScope("just-premium",t)},t=e=>{const t=Array.from(e.classList);for(const e of t)if(e.startsWith("jpx-")&&e.endsWith("-container"))return!0;return!1};try{const a=this.topMostAccessibleFrameWindow.parent.document.querySelectorAll('div[class^="jpx-"]'),i=Array.from(a).find(t);return i||(e(),this.target)}catch(t){return e(t.message),this.target}},this.target=this.getInternalAdTarget()}}t.JustPremiumFixedAd=o},6042:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VelocityAd=void 0;const i=a(7098),n=a(8367);class r extends n.InternalTargetAd{constructor(e){super(e),this.getInternalAdTarget=()=>{const e="#aip-tracking";try{const t=this.topMostAccessibleFrameWindow.parent.document.querySelector(e);return t||(i.Logger.error.withScope("playground",`Target element not found using query selector "${e}"`),this.target)}catch(t){return i.Logger.error.withScope("playground","Error when accessing the internal div element with id "+e,t),this.target}},this.target=this.getInternalAdTarget()}}t.VelocityAd=r},9788:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.YouTubeAd=void 0;const i=a(8075),n=a(3426),r=a(7240);class o extends i.BaseAd{constructor(e){super(e),this.isInGaze=e=>{const{x:t,y:a}=e,{isActiveTab:i,adState:o}=r.youtubeStore.getMany("isActiveTab","adState"),s=i&&o===n.YOUTUBE_AD_STATE.PLAYING;if(void 0===t||void 0===a||!s)return!1;this.adRect=this.target.getBoundingClientRect();const{left:d,right:l,top:c,bottom:u}=this.adRect;return t>=d&&t<=l&&a>=c&&a<=u},this.playProgress=0}}t.YouTubeAd=o},6376:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initialiseAdSession=t.adSessionTimeoutHandler=t.endAdSession=t.removeAdTarget=void 0;const i=a(4528),n=a(1763),r=a(395),o=a(8454),s=a(7098),d=a(6001),l=a(7240);t.removeAdTarget=e=>{s.Logger.log("Removing ad target - "+e.id),l.adStore.actions.removeAd(e),l.measurementStore.actions.removeIntersectionObserver(e)};t.endAdSession=e=>{if((0,d.dispatchLatestSyntheticIntersectionEvents)(),(0,d.cleanUpEventTimelines)(),(0,t.removeAdTarget)(e),window.__amt_mode__===n.Mode.CREATIVE){l.measurementStore.queries.browsingDynamicsIntervals().forEach(e=>{l.measurementStore.actions.removeBrowsingDynamicsInterval(e),clearInterval(e.id)})}};t.adSessionTimeoutHandler=e=>()=>{s.Logger.log("Maximum ad session length has been reached"),(0,t.endAdSession)(e)};t.initialiseAdSession=e=>{(0,r.dispatchApiData)(l.apiStore.get("apiFeed"),"event",[Object.assign({phase:o.AMTCustomEventPhase.AMT_CAPTURE_EVENTS},(0,r.getCustomEventDetailByAd)(e))]),window.setTimeout((0,t.adSessionTimeoutHandler)(e),1e3*i.config.eventCollection.maxSessionLengthSeconds)}},6419:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addResumeNotificationListener=t.addPauseNotificationListener=t.resumeNotificationHandler=t.removeSwappedAd=t.pauseNotificationHandler=void 0;const i=a(6376),n=a(423),r=a(7240),o=a(7623),s=a(4870),d=a(7098);t.pauseNotificationHandler=e=>{d.Logger.log.withScope("ad-swap",`ADSWAPPING - PAUSE EVENT NOTIFICATION, timestamp: ${(new Date).getTime()}, event detail: `,e.detail);const{impressionId:t}=e.detail;r.vpStore.actions.setAdTargetAdSwapStatus(t,n.AdSwapStatusEnum.PAUSED)};t.removeSwappedAd=e=>{const t=r.adStore.get("detectedAds").find(t=>t.id===e);if(d.Logger.log.withScope("ad-swap",`ADSWAPPING - REMOVING AD - ${e}: `,t),t){(0,o.captureEndEvent)(t,s.EndReason.AD_SWAP),(0,i.endAdSession)(t);const a=r.adStore.get("detectedAds").find(t=>t.id===e);d.Logger.log.withScope("ad-swap",`ADSWAPPING - REMOVED AD - ${e}: `,a)}};t.resumeNotificationHandler=e=>{d.Logger.log.withScope("ad-swap",`ADSWAPPING - RESUME EVENT NOTIFICATION, timestamp: ${(new Date).getTime()}, event detail: `,e.detail);const{swapped:a,impressionId:i}=e.detail;r.vpStore.actions.setAdTargetAdSwapStatus(i,n.AdSwapStatusEnum.RESUMED),a&&(0,t.removeSwappedAd)(i)};t.addPauseNotificationListener=e=>{e.addEventListener(n.AdSwapNotificationEnum.PAUSE,t.pauseNotificationHandler)};t.addResumeNotificationListener=e=>{e.addEventListener(n.AdSwapNotificationEnum.RESUME,t.resumeNotificationHandler)}},6001:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchLatestSyntheticIntersectionEvents=t.cleanUpEventTimelines=t.batchDispatchIntervalEvents=t.addToManagedTimelineDispatch=t.batchDispatchSyntheticMeasureEvents=t.batchDispatchRawMeasurementEvents=t.getIntervalEventsPerAdForMode=t.dispatchMeasurementEventsInStoredBatch=t.dispatchMeasurementEventsByFlag=t.dispatchMeasurementEvents=t.INTERVAL_EVENTS_PER_AD_BY_MODE=t.DEFAULT_INTERVAL_EVENTS_PER_AD=t.MINIMUM_REQUEST_INTERVAL=void 0;const n=a(7325),r=i(a(4405)),o=a(4528),s=a(4283),d=a(1763),l=a(7240),c=a(7098),u=a(9500),{eventCollection:g}=o.config;t.MINIMUM_REQUEST_INTERVAL=1e3,t.DEFAULT_INTERVAL_EVENTS_PER_AD=15,t.INTERVAL_EVENTS_PER_AD_BY_MODE={[d.Mode.YOUTUBE]:5,[d.Mode.PAGE]:t.DEFAULT_INTERVAL_EVENTS_PER_AD,[d.Mode.CREATIVE]:t.DEFAULT_INTERVAL_EVENTS_PER_AD};t.dispatchMeasurementEvents=e=>{if(c.Logger.log.withScope("api","dispatching measurement events",e),!e.length)return;if(!g.enabled)return void("production"===s.Environment.DEVELOPMENT&&r.default.emit("event",JSON.stringify(e)));const t=l.creativeStore.get("advertiserExtCode"),a=t?`${g.apiUrl}/${t}`:g.apiUrl;fetch(a,{method:"POST",body:JSON.stringify(e),headers:{Accepts:"application/json","Content-Type":"application/json","Amt-Event":g.token},keepalive:!0}).catch(e=>{c.Logger.error(e.message)})};t.dispatchMeasurementEventsByFlag=e=>{const a=l.apiStore.get("disableEventDispatch"),i=!!l.adStore.get("detectedAds").length;a?a&&i&&(c.Logger.log(`dispatching disabled, store the events with quantity: ${e.length} `,e),l.apiStore.actions.insertStoredBatch(e)):(0,t.dispatchMeasurementEvents)(e)};t.dispatchMeasurementEventsInStoredBatch=e=>{for(;l.apiStore.get("storedBatch").length>0;){const a=l.apiStore.actions.removeStoredBatch(e);c.Logger.log("dispatching the stored events in batches, total events in the batch: "+a.length),(0,t.dispatchMeasurementEvents)(a)}};t.getIntervalEventsPerAdForMode=e=>e&&t.INTERVAL_EVENTS_PER_AD_BY_MODE[e]||t.DEFAULT_INTERVAL_EVENTS_PER_AD;t.batchDispatchRawMeasurementEvents=()=>{const e=l.apiStore.actions.removeRawEvents(n.MAX_EVENTS_PER_REQUEST);(0,t.dispatchMeasurementEventsByFlag)(e)};t.batchDispatchSyntheticMeasureEvents=()=>{const e=l.apiStore.actions.removeSyntheticEvents(n.MAX_EVENTS_PER_REQUEST);(0,t.dispatchMeasurementEventsByFlag)(e)},t.addToManagedTimelineDispatch=(0,n.managedTimelineDispatch)(t.batchDispatchRawMeasurementEvents,t.batchDispatchSyntheticMeasureEvents,t.MINIMUM_REQUEST_INTERVAL,!0);t.batchDispatchIntervalEvents=()=>{const e=l.apiStore.get("intervalEventTimeline"),a=l.adStore.get("detectedAds").length*(0,t.getIntervalEventsPerAdForMode)(window.__amt_mode__);if(e.length>=a){const e=l.apiStore.actions.removeIntervalEvents(n.MAX_EVENTS_PER_REQUEST);(0,t.dispatchMeasurementEventsByFlag)(e)}};t.cleanUpEventTimelines=()=>{for(;l.apiStore.get("rawEventTimeline").length>0;){const e=l.apiStore.actions.removeRawEvents(n.MAX_EVENTS_PER_REQUEST);(0,t.dispatchMeasurementEvents)(e)}for(;l.apiStore.get("intervalEventTimeline").length>0;){const e=l.apiStore.actions.removeIntervalEvents(n.MAX_EVENTS_PER_REQUEST);(0,t.dispatchMeasurementEvents)(e)}for(;l.apiStore.get("syntheticEventTimeline").length>0;){const e=l.apiStore.actions.removeSyntheticEvents(n.MAX_EVENTS_PER_REQUEST);(0,t.dispatchMeasurementEvents)(e)}};t.dispatchLatestSyntheticIntersectionEvents=()=>{const e=(0,u.getSyntheticIntersectionEvents)();(0,t.dispatchMeasurementEvents)(e)}},129:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkVpClient=void 0;const i=a(7098);t.checkVpClient=e=>{if(null===window.top)return e({error:"Could not access top window."});const t=new MessageChannel,a=window.setTimeout(()=>{t.port1.close(),e({error:"VP Check timed out after 1000ms"})},1e3);t.port1.onmessage=i=>{var n;clearTimeout(a),t.port1.close(),e("object"==typeof(n=i.data)&&null!==n&&["client","version"].every(e=>"string"==typeof n[e])?{client:i.data.client,version:i.data.version}:{error:"Vision Project client response malformed."})};try{window.top.postMessage({action:"inspect-vp-context"},"*",[t.port2])}catch(t){i.Logger.error(t.message),e({error:t.message})}}},1259:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAllQueryParametersFromSrc=t.getAttributeValueFromSrc=t.getPathParamValueFromSrc=t.getCurrentScript=void 0;const i=a(7098);t.getCurrentScript=e=>e.currentScript||Array.prototype.slice.call(e.scripts).find(e=>e.src.match("/amt"));t.getPathParamValueFromSrc=(e,t)=>{var a,i,n;return null!==(n=null===(i=null===(a=null==e?void 0:e.pathname)||void 0===a?void 0:a.match(t))||void 0===i?void 0:i[0])&&void 0!==n?n:null};t.getAttributeValueFromSrc=(e,t)=>e.queryParams.get(t);t.getAllQueryParametersFromSrc=e=>{try{const t=[];return e.queryParams.forEach((e,a)=>{t.push([a,e])}),t}catch(e){i.Logger.log("Failed to get query parameters from src - "+e.message)}return[]}},2333:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getReferrerFromDcmIframeUrl=t.getReferrerFromDcmInsAttributes=t.getReferrerFromParams=t.getDcmInsIframeSrc=t.getDcmInsScriptElement=t.DCM_DATA_ATTRS=t.DCM_DATA_PARAM=t.DCM_IFRAME_TEST_HOST=t.DCM_SCRIPT_TEST_ATTR=void 0;const i=a(7162),n=a(7098);t.DCM_SCRIPT_TEST_ATTR="data-dcm-rendering-mode",t.DCM_IFRAME_TEST_HOST="ad.doubleclick.net",t.DCM_DATA_PARAM="data-dcm-param",t.DCM_DATA_ATTRS=["referrer-xandr","referrer-ttd","referrer-dv360","referrer-mediamath","referrer-amobee"];t.getDcmInsScriptElement=e=>e.querySelector(`ins[${t.DCM_SCRIPT_TEST_ATTR}]`)||null;t.getDcmInsIframeSrc=e=>{if(!e)return null;let a=null;try{a=e.location&&e.location.href.indexOf(t.DCM_IFRAME_TEST_HOST)>-1?decodeURIComponent(e.location.href):null}catch(e){n.Logger.error("Unable to decode the url - "+e)}return a||null};t.getReferrerFromParams=e=>e.map(i.sanitiseReferrer).filter(e=>!!e)[0]||null;t.getReferrerFromDcmInsAttributes=e=>(0,t.getReferrerFromParams)(t.DCM_DATA_ATTRS.map(a=>e.getAttribute(`${t.DCM_DATA_PARAM}-${a}`)))||null;t.getReferrerFromDcmIframeUrl=e=>{const a=e.split(";").map(e=>{const a=e.split("=");return 2===a.length&&t.DCM_DATA_ATTRS.includes(a[0])?a[1]:null});return(0,t.getReferrerFromParams)(a)||null}},1915:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isValidCampaign=t.getEntityInformation=t.ENTITY_ATTRIBUTES=t.LINE_ITEM_NAME_ATTRIBUTE=t.LINE_ITEM_ID_ATTRIBUTE=t.CAMPAIGN_ID_ATTRIBUTE=t.ORGANISATION_ID_ATTRIBUTE=t.CREATIVE_NAME_ATTRIBUTE=t.CREATIVE_ID_ATTRIBUTE=void 0,t.CREATIVE_ID_ATTRIBUTE="creative-id",t.CREATIVE_NAME_ATTRIBUTE="creative-name",t.ORGANISATION_ID_ATTRIBUTE="organisation-id",t.CAMPAIGN_ID_ATTRIBUTE="campaign-id",t.LINE_ITEM_ID_ATTRIBUTE="line-item-id",t.LINE_ITEM_NAME_ATTRIBUTE="line-item-name",t.ENTITY_ATTRIBUTES=[t.CREATIVE_ID_ATTRIBUTE,t.CREATIVE_NAME_ATTRIBUTE,t.ORGANISATION_ID_ATTRIBUTE,t.CAMPAIGN_ID_ATTRIBUTE,t.LINE_ITEM_ID_ATTRIBUTE,t.LINE_ITEM_NAME_ATTRIBUTE];t.getEntityInformation=e=>({creativeId:e.queryParams.get(t.CREATIVE_ID_ATTRIBUTE),creativeName:e.queryParams.get(t.CREATIVE_NAME_ATTRIBUTE),organisationId:e.queryParams.get(t.ORGANISATION_ID_ATTRIBUTE),campaignId:e.queryParams.get(t.CAMPAIGN_ID_ATTRIBUTE),lineItemId:e.queryParams.get(t.LINE_ITEM_ID_ATTRIBUTE),lineItemName:e.queryParams.get(t.LINE_ITEM_NAME_ATTRIBUTE)});const a=["0b53a56e-9da1-497b-a6bf-7fe07d6c457b","5aa05930-f5b0-11ec-9b47-5fd29029ceb2","6123fb40-f5b0-11ec-97c6-a1949c36bcfe","7b0703e0-1f1e-11ec-918f-c5932782ded0","0c296700-fead-11ec-b971-213b67261b0e","9bc56410-3142-11ec-8ad3-51c10deb97d5"];t.isValidCampaign=e=>!a.includes(e)},111:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isApiStreamEnabled=t.isValidInternalDataVendor=t.getDataVendorAttribute=t.INTERNAL_DATA_VENDORS=t.DATA_VENDOR_ATTRIBUTE=void 0;const i=a(4283),n=a(1259),r=a(6048);t.DATA_VENDOR_ATTRIBUTE="data-vendor",t.INTERNAL_DATA_VENDORS=["vision-project"];t.getDataVendorAttribute=e=>{if(e){const a=document.createElement("script");a.setAttribute("src",e);const i=(0,r.createAmtDomScript)(a);return(0,n.getAttributeValueFromSrc)(i,t.DATA_VENDOR_ATTRIBUTE)}return null};t.isValidInternalDataVendor=e=>!(!e||!e.name)&&t.INTERNAL_DATA_VENDORS.indexOf(e.name)>=0;t.isApiStreamEnabled=e=>{const a=(0,n.getCurrentScript)(document),r=a?a.getAttribute("src"):null,o={name:(0,t.getDataVendorAttribute)(r)};return e===i.Environment.STAGING||e===i.Environment.DEVELOPMENT||e===i.Environment.TESTING||(0,t.isValidInternalDataVendor)(o)}},757:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adSwapEventMap=void 0;const i=a(6332);t.adSwapEventMap={"amt:adswap:end":e=>({id:e.id,timestamp:Date.now(),type:i.EventType.END_EVENT,endReason:e.endReason})}},9727:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalEventFactory=void 0;const i=a(1451),n=a(3478),r=a(5065),o=a(1283),s=a(3439),d=a(1503),l=a(757),c=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n.loadEventMap),r.measureEventMap),o.metadataEventMap),s.youTubeEventMap),d.offlineEventMap),l.adSwapEventMap);t.globalEventFactory=new i.Factory({constructors:c})},3478:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadEventMap=void 0;const i=a(6332),n=a(5898),r=a(3648),o=a(7240),s=a(5990),d=a(1763),l=e=>{var t,a,n,r,o,s,d,l,c,u,g,p;return{id:e.ad.id,timestamp:Date.now(),timeOffset:-(new Date).getTimezoneOffset(),type:i.EventType.LOAD_EVENT,mode:e.mode,pageAccess:e.pageAccess,referrer:e.referrer,format:e.ad.format,instantiationTimestamp:e.instantiationTimestamp,entities:null!==(t=e.entities)&&void 0!==t?t:null,adDimensions:e.adDimensions,windowDimensions:{width:e.topWindow.outerWidth,height:e.topWindow.outerHeight},screenDimensions:{height:e.topWindow.screen.height,width:e.topWindow.screen.width},viewport:null!==(a=e.viewport)&&void 0!==a?a:null,amtVersion:"1.27.1",dataVendor:null!==(n=e.dataVendor)&&void 0!==n?n:null,dataAttributes:null!==(r=e.customMacroValues)&&void 0!==r?r:null,creativeModeAttributes:null!==(o=e.creativeModeAttributes)&&void 0!==o?o:null,sampleRate:null!==(s=e.sampleRate)&&void 0!==s?s:null,tag:null!==(d=e.tag)&&void 0!==d?d:null,isSwapped:null!==(l=e.isSwapped)&&void 0!==l&&l,richMediaVendor:null!==(c=e.richMediaVendor)&&void 0!==c?c:null,part:null!==(u=e.part)&&void 0!==u?u:null,videoMetadata:null!==(g=e.videoMetadata)&&void 0!==g?g:null,groupKey:null!==(p=e.groupKey)&&void 0!==p?p:null}};t.loadEventMap={"amt:load:page":e=>{const t=(0,n.getLocation)(window),a=e.ad.getAdDimensions(),i=(0,r.getViewportDimensions)(window),c=o.creativeStore.get("tagSamplingAttributes"),u=e.tag?(0,s.getUpdatedTagInCapturing)(e.tag,c):null;return l({ad:e.ad,mode:d.Mode.PAGE,topWindow:window,pageAccess:!0,entities:e.entities,customMacroValues:e.customMacroValues,instantiationTimestamp:e.instantiationTimestamp,dataVendor:e.dataVendor,adDimensions:a,viewport:i,referrer:t,creativeModeAttributes:e.creativeModeAttributes,sampleRate:e.sampleRate,tag:u})},"amt:load:creative":e=>{var t,a,i,c,u;const g=e.ad.topMostAccessibleFrameWindow,p=e.ad.getAdDimensions(),E=(0,r.getViewportForCreative)(window,g),v="playgroundxyz"===(null===(t=e.richMediaParams)||void 0===t?void 0:t.richMediaVendor)&&e.ad.target.hasAttribute("vp-target-ad"),_=o.creativeStore.get("tagSamplingAttributes"),T=e.tag?(0,s.getUpdatedTagInCapturing)(e.tag,_):null,m=null!==(i=null===(a=e.requiredMacros)||void 0===a?void 0:a.referrer)&&void 0!==i?i:(0,n.getLocation)(window);return l({ad:e.ad,mode:d.Mode.CREATIVE,topWindow:g,pageAccess:e.ad.pageAccess,entities:e.entities,customMacroValues:e.customMacroValues,instantiationTimestamp:e.instantiationTimestamp,dataVendor:e.dataVendor,adDimensions:p,viewport:E,referrer:m,sampleRate:e.sampleRate,tag:T,isSwapped:v,richMediaVendor:null===(c=e.richMediaParams)||void 0===c?void 0:c.richMediaVendor,part:null===(u=e.richMediaParams)||void 0===u?void 0:u.richMediaPart,groupKey:e.groupKey})},"amt:load:youtube":e=>{const t=e.ad.getAdDimensions(),a=(0,r.getViewportDimensions)(window),i=(0,n.getLocation)(window);return l({ad:e.ad,mode:d.Mode.YOUTUBE,topWindow:window,pageAccess:!0,entities:e.entities,customMacroValues:e.customMacroValues,instantiationTimestamp:e.instantiationTimestamp,dataVendor:e.dataVendor,videoMetadata:e.videoMetadata,referrer:i,viewport:a,adDimensions:t})}}},5065:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.measureEventMap=void 0;const i=a(6332),n=a(4616),r=a(6881);t.measureEventMap={"amt:measure:gaze":e=>{var t,a,n,r,o,s,d;return{id:e.id,timestamp:e.timestamp,type:i.EventType.MEASURE_EVENT,gaze:{inGaze:e.inGaze,gazeVendor:null!==(t=e.gazeVendor)&&void 0!==t?t:null,coordinates:{x:null!==(a=e.x)&&void 0!==a?a:null,y:null!==(n=e.y)&&void 0!==n?n:null},gazeIdentifiers:e.gazeIdentifiers?{pageId:null!==(r=e.gazeIdentifiers.pageId)&&void 0!==r?r:null,userId:null!==(o=e.gazeIdentifiers.userId)&&void 0!==o?o:null,sessionId:null!==(s=e.gazeIdentifiers.sessionId)&&void 0!==s?s:null,feedId:null!==(d=e.gazeIdentifiers.feedId)&&void 0!==d?d:null}:null},browsingFeatures:{adLocation:e.adLocation}}},"amt:measure:browsing-features":e=>{var t;return{id:e.id,type:i.EventType.MEASURE_EVENT,timestamp:null!==(t=e.timestamp)&&void 0!==t?t:Date.now(),browsingFeatures:e.browsingFeatures}},"amt:measure:inview":e=>{var t;const{ad:a,timestamp:o,inView:s,richMediaParams:d}=e,l=null!==(t=null==d?void 0:d.richMediaFormat)&&void 0!==t?t:null,{target:c,topMostAccessibleFrameWindow:u}=a,g=(0,n.getAdFormat)({richMediaFormat:l,target:c,window:u}),p=a.getAdDimensions(),E=(0,r.getWindowDimensions)(u);return{id:a.id,type:i.EventType.MEASURE_EVENT,timestamp:null!=o?o:Date.now(),format:g,inView:s,adDimensions:p,windowDimensions:E}}}},1283:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.metadataEventMap=void 0;const i=a(6332),n=a(3194),r=a(4611);t.metadataEventMap={"amt:metadata:vision-project-metadata":e=>({id:e.id,type:i.EventType.VISION_PROJECT_METADATA_EVENT,timestamp:Date.now(),visionProjectMetadata:e.vpMetadata}),"amt:metadata:page":e=>{const{id:t,win:a}=e;return{id:t,type:i.EventType.PAGE_EVENT,timestamp:Date.now(),adSlots:(0,n.findAllAds)(a.top?a.top:a).map(e=>(0,n.getIframeDimensions)(e)),pageDimensions:(0,r.getPageDimensions)(a)}}}},1503:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.offlineEventMap=void 0;const i=a(6332);t.offlineEventMap={"amt:offline:image":e=>{const{id:t,adContent:a}=e;return{id:t,type:i.EventType.OFFLINE_EVENT,timestamp:Date.now(),adContent:a}}}},3439:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.youTubeEventMap=void 0;const i=a(6332),n=a(7964),r=a(7079),o=e=>{var t,a;return{id:e.adId,timestamp:null!==(t=e.originalEventTimestamp)&&void 0!==t?t:Date.now(),type:i.EventType.TRIGGERED_EVENT,triggeredEvent:{type:e.trigger},viewableStatus:{totalViewableTime:null!==(a=e.totalViewableTime)&&void 0!==a?a:null}}};t.youTubeEventMap={"amt:youtube:trigger-mute":e=>o({adId:e.adId,trigger:e.isMuted?n.Trigger.MUTE:n.Trigger.UNMUTE,originalEventTimestamp:e.originalEventTimestamp}),"amt:youtube:trigger-skip":e=>o({trigger:n.Trigger.SKIP,totalViewableTime:e.totalViewableTime,adId:e.adId,originalEventTimestamp:e.originalEventTimestamp}),"amt:youtube:trigger-fullscreen":e=>o({adId:e.adId,trigger:e.isFullScreen?n.Trigger.FULLSCREEN_ON:n.Trigger.FULLSCREEN_OFF,originalEventTimestamp:e.originalEventTimestamp}),"amt:youtube:trigger-abandon":e=>o({adId:e.adId,trigger:n.Trigger.ABANDON,totalViewableTime:e.totalViewableTime,originalEventTimestamp:e.originalEventTimestamp}),"amt:youtube:trigger-play":e=>o({adId:e.adId,trigger:n.Trigger.PLAY,originalEventTimestamp:e.originalEventTimestamp}),"amt:youtube:trigger-pause":e=>o({adId:e.adId,trigger:n.Trigger.PAUSE,originalEventTimestamp:e.originalEventTimestamp}),"amt:youtube:trigger-clickthrough":e=>o({adId:e.adId,trigger:n.Trigger.CLICKTHROUGH,originalEventTimestamp:e.originalEventTimestamp}),"amt:youtube:video-progress":e=>{var t,a;return{id:e.adId,type:i.EventType.VIDEO_PROGRESS_EVENT,timestamp:null!==(t=e.originalEventTimestamp)&&void 0!==t?t:Date.now(),viewableStatus:{totalViewableTime:null!==(a=e.totalViewableTime)&&void 0!==a?a:null},videoProgress:{label:"play_progress_"+e.checkpoint,elapsedDuration:e.elapsedDuration}}},"amt:youtube:video-state":e=>{var t,a;return{id:e.adId,timestamp:null!==(t=e.originalEventTimestamp)&&void 0!==t?t:Date.now(),type:i.EventType.MEASURE_EVENT,videoState:{currentTime:e.currentTime},viewableStatus:{totalViewableTime:null!==(a=e.totalViewableTime)&&void 0!==a?a:null}}},"amt:youtube:viewable":e=>{const{adId:t,originalEventTimestamp:a,viewableTimeViewportCoverageIntervals:n,totalIabViewableTime:o}=e;return{id:t,type:i.EventType.VIEWABLE_EVENT,timestamp:null!=a?a:Date.now(),viewableStatus:{totalViewableTime:n[r.ViewportCoverageInterval.INTERVAL_0],totalIabViewableTime:o,viewableTimeViewportCoverageIntervals:n}}}}},2507:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.doRectanglesIntersect=void 0;t.doRectanglesIntersect=(e,t)=>e.left<=t.right&&t.left<=e.right&&e.top<=t.bottom&&t.top<=e.bottom},5887:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalEventBus=void 0;const i=a(4747);t.globalEventBus=i.busFactory.create("global")},7240:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.creativeStore=t.systemStore=t.youtubeStore=t.measurementStore=t.vpStore=t.adStore=t.apiStore=void 0;const i=a(6136),n=i.storeFactory.create("api");t.apiStore=n;const r=i.storeFactory.create("ad");t.adStore=r;const o=i.storeFactory.create("visionProject");t.vpStore=o;const s=i.storeFactory.create("measurement");t.measurementStore=s;const d=i.storeFactory.create("system");t.systemStore=d;const l=i.storeFactory.create("creative");t.creativeStore=l;const c=i.storeFactory.create("youtube");t.youtubeStore=c},6359:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hashString=void 0;t.hashString=e=>e.split("").map(e=>e.charCodeAt(0)).reduce((e,t)=>e+((e<<7)+(e<<3))^t).toString(16).replace("-","X")},3194:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTopMostAccessibleParentIframeWindow=t.getDeepestAvailableHTMLContent=t.createHtmlTree=t.getHTMLContentFromIframe=t.findAllAds=t.findSupportedAds=t.filterIframes=t.findIframes=t.filterIframesForSupportedAds=t.iframeSizeComparison=t.getIframeDimensions=void 0;const i=a(497),n=a(1763),r=a(7098);t.getIframeDimensions=e=>{const t=e.getBoundingClientRect();return{height:Math.round(t.height)||e.offsetHeight||e.clientHeight||0,width:Math.round(t.width)||e.offsetWidth||e.clientWidth||0}};t.iframeSizeComparison=(e,a)=>{const r=(0,t.getIframeDimensions)(e);if(!a.enabled)return!1;const o=window.__amt_mode__===n.Mode.CREATIVE&&a.tolerance||i.SIZE_TOLERANCE,s=e=>Math.max(e,10);return r.width>=s(a.width-o)&&r.width<=a.width+o&&r.height>=s(a.height-o)&&r.height<=a.height+o};t.filterIframesForSupportedAds=e=>e.filter(e=>i.supportedIABAdFormats.some(a=>(0,t.iframeSizeComparison)(e,a)));t.findIframes=e=>Array.from(e.document.getElementsByTagName("iframe"));t.filterIframes=e=>Array.from(e).filter(e=>"IFRAME"===e.nodeName);t.findSupportedAds=e=>(0,t.filterIframesForSupportedAds)((0,t.findIframes)(e));t.findAllAds=e=>(0,t.findIframes)(e);t.getHTMLContentFromIframe=e=>{var t;return(null===(t=e.contentWindow)||void 0===t?void 0:t.document.documentElement.outerHTML)||null};t.createHtmlTree=(e,a,i=0)=>{const n=(0,t.getHTMLContentFromIframe)(a),{contentWindow:r}=a;if(n&&r){e[i]=e[i]?e[i].concat(n):[n];const a=(0,t.findSupportedAds)(r),o=i+1;return a.reduce((e,a)=>(0,t.createHtmlTree)(e,a,o),e)}return e};t.getDeepestAvailableHTMLContent=e=>{try{const a=(0,t.createHtmlTree)([],e);return a[a.length-1][0]}catch(a){return r.Logger.error("Unable to access iframe content - "+a.message,a),(0,t.getHTMLContentFromIframe)(e)}};t.getTopMostAccessibleParentIframeWindow=e=>{if(!!!e.frameElement||e.top===e.parent)return e;const a=e.parent;return(0,t.getTopMostAccessibleParentIframeWindow)(a)}},3466:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isInjectedAmt=t.INJECTED_ATTR=void 0,t.INJECTED_ATTR="injectedAmt";t.isInjectedAmt=e=>!(!e||"true"!==e.getAttribute(t.INJECTED_ATTR))},3628:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.instantiateIntersectionObserver=t.getThresholdForMode=t.getIntersectionObserverOptions=t.generateThresholds=t.calculateThresholdEntry=t.DEFAULT_TOTAL_ENTRIES=t.VIDEO_TOTAL_ENTRIES=void 0;const i=a(1763),n=a(7240);t.VIDEO_TOTAL_ENTRIES=101,t.DEFAULT_TOTAL_ENTRIES=1001;t.calculateThresholdEntry=(e,t)=>e/(t-1);t.generateThresholds=e=>new Array(e).fill(void 0).map((e,a,i)=>(0,t.calculateThresholdEntry)(a,i.length));t.getIntersectionObserverOptions=e=>({root:null,rootMargin:"0px",threshold:e});t.getThresholdForMode=e=>{switch(e){case i.Mode.YOUTUBE:return(0,t.generateThresholds)(t.VIDEO_TOTAL_ENTRIES);default:return(0,t.generateThresholds)(t.DEFAULT_TOTAL_ENTRIES)}};t.instantiateIntersectionObserver=(e,a,i)=>{if(window.IntersectionObserver){if(n.adStore.get("detectedAds").find(e=>e.id===a.id)){const r=(0,t.getIntersectionObserverOptions)((0,t.getThresholdForMode)(i)),o=new IntersectionObserver(e,r);n.measurementStore.actions.insertIntersectionObserver(a,o),o.observe(a.target)}}}},5448:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LogDispatcher=t.AMT_TOKEN_HEADER=void 0;const i=a(7098);t.AMT_TOKEN_HEADER="Amt-Event";t.LogDispatcher=class{constructor(e){this.init=()=>{this.eventBus.subscribe("log:dispatch",this.onLog)},this.onLog=e=>{var a;const n=[{scriptName:"AMT",scriptVersion:"1.27.1",message:e.message,level:null!==(a=e.level)&&void 0!==a?a:"info"}];fetch(this.apiUrl,{method:"POST",body:JSON.stringify(n),headers:{Accepts:"application/json","Content-Type":"application/json",[t.AMT_TOKEN_HEADER]:this.apiToken},keepalive:!0}).catch(e=>{i.Logger.error(e.message)})},this.eventBus=e.eventBus,this.apiToken=e.apiToken,this.apiUrl=e.apiUrl}}},7098:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;const i=a(7603);class n{}t.Logger=n,n.emitLogMessage=(e,...t)=>{if(0===t.length)return;const{scope:a,logLevel:i}=e},n.logFor=e=>{const t=(...t)=>n.emitLogMessage({logLevel:e},...t);return t.withScope=(t,...a)=>n.emitLogMessage({logLevel:e,scope:t},...a),t},n.debug=n.logFor(i.LOG_LEVEL.DEBUG),n.log=n.logFor(i.LOG_LEVEL.LOG),n.info=n.logFor(i.LOG_LEVEL.INFO),n.warn=n.logFor(i.LOG_LEVEL.WARN),n.error=n.logFor(i.LOG_LEVEL.ERROR)},7162:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTagConfigFromEventCollectionCache=t.processTagConfigResponse=t.handleAdSessionBySampling=t.getTag=t.parseTagAutoId=t.splitTagLabel=t.getTagAttributes=t.getAllPlatformMacros=t.getCustomPlatformMacroValues=t.getCommonPlatformMacrosValues=t.sanitiseReferrer=t.isSubstitutedUrl=t.REFERRER_MACROS=t.DATA_VENDOR_ATTRIBUTES=t.RICH_MEDIA_ATTRIBUTES=t.AD_REMOVAL_TIMEOUT=t.AD_REMOVAL_INTERVAL=t.TAG_CONFIG_REQUEST_TIMEOUT=t.TAG_CODE_PARAM_REGEX=t.REQUIRED_TAG_ATTRIBUTES=t.TAG_ID_KEY=t.TAG_LABEL_KEY=t.ADVERTISER_ENTITY_KEY=t.EXTERNAL_ENTITY_MACRO_PREFIX=t.REQUIRED_CREATIVE_MACRO_ATTRIBUTES=t.REFERRER=void 0;const i=a(1915),n=a(1259),r=a(2333),o=a(4814),s=a(7240),d=a(6376),l=a(6001),c=a(4528),u=a(5990),g=a(7325),p=a(7098),E=a(8842),v=a(5887);t.REFERRER="referrer",t.REQUIRED_CREATIVE_MACRO_ATTRIBUTES=[t.REFERRER],t.EXTERNAL_ENTITY_MACRO_PREFIX="attr",t.ADVERTISER_ENTITY_KEY=t.EXTERNAL_ENTITY_MACRO_PREFIX+"Advertiser",t.TAG_LABEL_KEY="tagLabel",t.TAG_ID_KEY="tagId",t.REQUIRED_TAG_ATTRIBUTES=[t.TAG_LABEL_KEY,t.TAG_ID_KEY],t.TAG_CODE_PARAM_REGEX=/[0-9]{1,10}-[a-zA-Z0-9]{8}/,t.TAG_CONFIG_REQUEST_TIMEOUT=7e3;const{macroTag:{defaultConfig:{global:{sampleRate:_}}}}=c.config;t.AD_REMOVAL_INTERVAL=1e3,t.AD_REMOVAL_TIMEOUT=2e4;const T={"23-0c594350":1,"24-5c5619a0":1,"47-60483ff0":1,"71-5aa35650":1,"48-bc9cad70":1,"76-e64f9dc0":.1};t.RICH_MEDIA_ATTRIBUTES=["richMediaFormat","richMediaPart","richMediaVendor"],t.DATA_VENDOR_ATTRIBUTES=["data-vendor"],t.REFERRER_MACROS=["${REFERER_URL_ENC}","${SOURCE_URL_ENC}","%%TTD_SITE_WITH_PATH%%","%%PATTERN:url%%","[BID_ATTR.page_url]","$!{SITE_URL}","!{REFERRER_ENC}"];const m=[...t.REQUIRED_CREATIVE_MACRO_ATTRIBUTES,...i.ENTITY_ATTRIBUTES,...t.REQUIRED_TAG_ATTRIBUTES,...t.RICH_MEDIA_ATTRIBUTES,...t.DATA_VENDOR_ATTRIBUTES];t.isSubstitutedUrl=e=>-1===t.REFERRER_MACROS.indexOf(e);t.sanitiseReferrer=e=>{if(e&&(0,t.isSubstitutedUrl)(e))try{return decodeURIComponent(e)}catch(e){p.Logger.error("macro","Failed to parse url - "+e.message)}return null};t.getCommonPlatformMacrosValues=e=>{if(e.srcString){const a=(0,n.getAttributeValueFromSrc)(e,t.REFERRER),i=(0,t.sanitiseReferrer)(a);if(i)return v.globalEventBus.publish("debug:referrer",{referrer:i,origin:E.ReferrerOrigin.SRC_SCRIPT}),{referrer:i}}const a=(0,r.getDcmInsScriptElement)(document);if(a){const e=(0,r.getReferrerFromDcmInsAttributes)(a);return e&&v.globalEventBus.publish("debug:referrer",{referrer:e,origin:E.ReferrerOrigin.DCIM_ATTRIBUTE}),{referrer:e}}const i=(0,r.getDcmInsIframeSrc)(window);if(i){const e=(0,r.getReferrerFromDcmIframeUrl)(i);return e&&v.globalEventBus.publish("debug:referrer",{referrer:e,origin:E.ReferrerOrigin.DCIM_IFRAME}),{referrer:e}}return{referrer:null}};t.getCustomPlatformMacroValues=e=>(0,n.getAllQueryParametersFromSrc)(e).filter(([e])=>-1===m.indexOf(e)).reduce((e,[t,a])=>Object.assign(Object.assign({},e),{[t]:a}),{});t.getAllPlatformMacros=e=>{if(!e.srcString)return{common:{referrer:null},custom:{}};return{common:(0,t.getCommonPlatformMacrosValues)(e),custom:(0,t.getCustomPlatformMacroValues)(e)}};t.getTagAttributes=e=>({code:(0,n.getPathParamValueFromSrc)(e,t.TAG_CODE_PARAM_REGEX),label:(0,n.getAttributeValueFromSrc)(e,t.TAG_LABEL_KEY)});t.splitTagLabel=e=>{if(!e)return{name:null,platform:null};const t=e.split("_"),a=t.length-1,i=t[t.length-1];return{name:t.splice(0,a).join("_"),platform:i}};t.parseTagAutoId=e=>{const t=parseInt(e[0],10),a=Number.isNaN(t)?null:t;return a||p.Logger.error("macro","Unable to parse the tag key auto id as a number"),a};t.getTag=(e,a,i)=>{if(!e||!e.code||!e.label)return null;const n=e.code.split("-");if(2!==n.length)return null;const r=(0,t.parseTagAutoId)(n);if(!r)return null;const s=e.code,d=(0,t.splitTagLabel)(e.label);return Object.assign({id:r,code:s,platform:d.platform,label:d.name},(0,o.getTagSampleRate)(a,i))};t.handleAdSessionBySampling=(e,a,i=!1)=>{if((0,o.applyTagSampling)(e)){p.Logger.log.withScope("macro","Sampling Passed!");const t=s.apiStore.get("storedBatch");i&&t.length&&(0,u.updateLoadEventInStoredBatch)(t,e,a),s.apiStore.set("disableEventDispatch",!1),(0,l.dispatchMeasurementEventsInStoredBatch)(g.MAX_EVENTS_PER_REQUEST)}else{let e,a;p.Logger.log.withScope("macro","impression not captured for macro tag sampling!"),s.apiStore.set("storedBatch",[]),e=window.setInterval(()=>{p.Logger.log.withScope("macro","Attempt to remove ad....");const t=s.adStore.get("detectedAds"),i=t.length?t[0]:null;i&&((0,d.endAdSession)(i),p.Logger.log.withScope("macro","Ad removed...."),window.clearTimeout(a),window.clearInterval(e))},t.AD_REMOVAL_INTERVAL),a=window.setTimeout(()=>{window.clearInterval(e)},t.AD_REMOVAL_TIMEOUT)}};t.processTagConfigResponse=(e,a)=>{const{tagConfig:i=null,statusCode:n=null}=e||{};if(p.Logger.log.withScope("macro","Retrieved the Macro Tag Config from Event Collection Cache:",i),n&&200===n&&i){const{sampleRate:e,overriddenByEntity:n}=(0,o.getTagSampleRate)(i,a);s.creativeStore.set("tagSamplingAttributes",{sampleRate:e,overriddenByEntity:n});const r=!0;(0,t.handleAdSessionBySampling)(e,n,r)}else if(n&&n>=300){const e=_,a=!1;(0,t.handleAdSessionBySampling)(e,a)}};t.getTagConfigFromEventCollectionCache=(e,a)=>{if(e in T){const a=T[e],i=!1,n=!0;return s.creativeStore.set("tagSamplingAttributes",{sampleRate:a,overriddenByEntity:i}),void(0,t.handleAdSessionBySampling)(a,i,n)}const i=c.config.eventCollection.token?{"Amt-Event":c.config.eventCollection.token}:{},n=new AbortController,r=setTimeout(()=>{n.abort(),p.Logger.error("Timeout occurred when retrieving the Macro Tag Config from Event Collection Cache"),(0,t.handleAdSessionBySampling)(_,!1)},t.TAG_CONFIG_REQUEST_TIMEOUT);return fetch(`${c.config.macroTag.apiUrl}/${e}`,{method:"GET",headers:i,signal:n.signal}).then(e=>(clearTimeout(r),e.json())).then(e=>(0,t.processTagConfigResponse)(e,a)).catch(()=>{p.Logger.error("Error occurred when retrieving the Macro Tag Config from Event Collection Cache"),(0,t.handleAdSessionBySampling)(_,!1)})}},7325:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.managedTimelineDispatch=t.MAX_EVENTS_PER_REQUEST=void 0;const i=a(9500),n=a(7240);t.MAX_EVENTS_PER_REQUEST=100;t.managedTimelineDispatch=(e,a,r,o)=>{let s,d,l=o,c=r;return()=>{const o=()=>{c*=1.5;const e=(0,i.getSyntheticIntersectionEvents)();e&&e.length&&(d=window.setTimeout(o,c),n.apiStore.actions.insertSyntheticEvents(e),a())};if(l)return(0,i.updateLatestIntersectionEventPerImpression)(),l=!1,void e();[s,d].map(e=>e&&window.clearTimeout(e));if(n.apiStore.get("rawEventTimeline").length>=t.MAX_EVENTS_PER_REQUEST)return(0,i.updateLatestIntersectionEventPerImpression)(),void e();s=window.setTimeout(()=>{s=null,d=null,c=r,(0,i.updateLatestIntersectionEventPerImpression)(),d=window.setTimeout(o,c),e()},r)}}},3977:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MathUtils=void 0;t.MathUtils=class{static isIntersecting(e,t){return void 0!==e.x&&void 0!==e.y&&(e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}}},6893:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.observeVideoChange=t.miniPlayerMutationHandler=t.createYouTubeApiMutationHandler=t.youTubePageChangeMutationHandler=t.createAdSwapMutationHandler=t.isAdSwappedMutation=t.MINI_PLAYER_MUTATION_OBSERVER_CONFIG=t.AD_SWAP_MUTATION_OBSERVER_CONFIG=t.DEFAULT_MUTATION_OBSERVER_CONFIG=void 0;const i=a(7240),n=a(9548),r=a(3194),o=a(1101),s=a(3426),d=a(7098);t.DEFAULT_MUTATION_OBSERVER_CONFIG={attributes:!1,childList:!0,subtree:!0},t.AD_SWAP_MUTATION_OBSERVER_CONFIG={attributes:!0,childList:!0,subtree:!0,attributeFilter:["srcdoc","src"]},t.MINI_PLAYER_MUTATION_OBSERVER_CONFIG={attributes:!0,childList:!0,subtree:!0,attributeFilter:["active"]};t.isAdSwappedMutation=e=>{const{attributeName:t,target:a,type:i}=e;return"attributes"===i&&"srcdoc"===t&&"IFRAME"===a.nodeName};t.createAdSwapMutationHandler=(e,a,i,n)=>(s,l)=>{for(const c of s)if((0,t.isAdSwappedMutation)(c)){const{type:t,attributeName:s,target:u}=c;d.Logger.log(`Ad swap mutation detected with mutation type: ${t} and attributeName: ${s}`),d.Logger.log("Ad swap target detected: ",u);const g=(0,r.filterIframesForSupportedAds)([u]);if(0===g.length)return;(0,o.attachLoadedAds)(g,e,a,i,n),l.disconnect();break}};t.youTubePageChangeMutationHandler=()=>{const{currentUrl:e,isMiniPlayerTransition:t,currentPlayerMode:a}=i.youtubeStore.getMany("currentUrl","isMiniPlayerTransition","currentPlayerMode");if(window.location.href!==e){if(i.youtubeStore.set("currentUrl",window.location.href),t)return void i.youtubeStore.set("isMiniPlayerTransition",!1);if(a===s.YOUTUBE_PLAYER_MODE.MINI_PLAYER)return;const e=!0;(0,n.handleAbandonTrigger)(null,e)}};t.createYouTubeApiMutationHandler=e=>(t,a)=>{for(const i of t)if(i.addedNodes.length){if(Array.from(i.addedNodes).some(e=>(null==e?void 0:e.id)===n.YT_PLAYER_ELEMENT_ID)){a.disconnect(),e();break}}};t.miniPlayerMutationHandler=e=>{for(const t of e){const{attributeName:e}=t;if("active"===e){const e=i.youtubeStore.get("miniPlayer");e&&i.youtubeStore.set("currentPlayerMode",e.hasAttribute("active")?s.YOUTUBE_PLAYER_MODE.MINI_PLAYER:s.YOUTUBE_PLAYER_MODE.DEFAULT)}}};t.observeVideoChange=(e,t)=>{new MutationObserver(e=>{for(const a of e)if(a.addedNodes.length){const e=Array.from(a.addedNodes).find(e=>"VIDEO"===e.nodeName);e&&t(e)}}).observe(e,{childList:!0,subtree:!0})}},2002:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pollFor=void 0;t.pollFor=(e,t,a,i)=>{var n,r;const o=100,s=1e3;let d,l;d=window.setInterval(()=>{e()&&(clearInterval(d),clearTimeout(l),t())},null!==(n=null==i?void 0:i.interval)&&void 0!==n?n:o),l=window.setTimeout(()=>{clearInterval(d),a()},null!==(r=null==i?void 0:i.maxWaitTime)&&void 0!==r?r:s)}},1169:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRichMediaQueryParams=t.isDesktopPXYZAdFrame=t.XYZ_AD_IFRAME=void 0;const i=a(4994);t.XYZ_AD_IFRAME="xyz-ad-iframe";t.isDesktopPXYZAdFrame=e=>e.parent.name===t.XYZ_AD_IFRAME;t.getRichMediaQueryParams=e=>({richMediaFormat:e.queryParams.get(i.RichMediaAttributes.RICH_MEDIA_FORMAT),richMediaPart:e.queryParams.get(i.RichMediaAttributes.RICH_MEDIA_PART),richMediaVendor:e.queryParams.get(i.RichMediaAttributes.RICH_MEDIA_VENDOR)})},5341:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listenToReferrer=void 0;const i=a(5887);t.listenToReferrer=()=>{let e,t;const a=()=>{if(e&&t){const a={impressionId:e.impressionId,referrer:{url:t.referrer,origin:t.origin}};i.globalEventBus.publish("log:dispatch",{message:a})}};i.globalEventBus.subscribe("debug:impressionId",t=>{e=t,a()}),i.globalEventBus.subscribe("debug:referrer",e=>{t=e,a()})}},3876:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isRichMediaVendor=void 0;const i=a(4994);t.isRichMediaVendor=e=>Object.values(i.RichMediaVendor).includes(e)},4814:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTagSampleRate=t.capitaliseEntityTypes=t.getSampleRateForPage=t.getSampleRateForCreative=t.applyTagSampling=t.applySampling=t.getRandomNumber=t.isNumber=t.TAG_SAMPLING_DECIMAL_PLACES=t.INTERNAL_DATA_VENDOR_SAMPLE_RATE=void 0;const i=a(7162),n=a(7098);t.INTERNAL_DATA_VENDOR_SAMPLE_RATE=100,t.TAG_SAMPLING_DECIMAL_PLACES=3;t.isNumber=e=>"number"==typeof e&&!Number.isNaN(e);t.getRandomNumber=(e,t,a=0)=>{if(0===a)return Math.floor(Math.random()*(t-e+1)+e);const i=Math.random()*(t-e)+e;return parseFloat(i.toFixed(a))};t.applySampling=e=>!(0,t.isNumber)(e)||(0,t.getRandomNumber)(1,100)<=e;t.applyTagSampling=e=>{if((0,t.isNumber)(e)){const a=100*e,i=(0,t.getRandomNumber)(1,100,t.TAG_SAMPLING_DECIMAL_PLACES);return n.Logger.log(`Applying tag sampling with random number: ${i}, and sample rate: ${a}`),i<=a}return!0};t.getSampleRateForCreative=(e,t)=>{const a=Object.keys(e).find(e=>e===(null==t?void 0:t.lineItemId));return a?e[a].sampleRate:null};t.getSampleRateForPage=e=>"number"==typeof e?e:null;t.capitaliseEntityTypes=e=>`${e.charAt(0).toUpperCase()}${e.slice(1)}`;t.getTagSampleRate=(e,a)=>{const{overrides:n,global:{sampleRate:r}}=e;if(!n)return{overriddenByEntity:!1,sampleRate:r};const o=a&&Object.entries(n).flatMap(([e,n])=>n.map(({targetId:n,sampleRate:r})=>a[`${i.EXTERNAL_ENTITY_MACRO_PREFIX}${(0,t.capitaliseEntityTypes)(e)}`]===n&&r)).find(t.isNumber),s="number"==typeof o;return{overriddenByEntity:s,sampleRate:s?o:r}}},6048:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createAmtDomScript=void 0;const i=a(7098),n=e=>{const t={},a=e.length;for(let i=0;i<a;i++){const a=e.item(i),n=null==a?void 0:a.name;n&&(t[n]=null==a?void 0:a.value)}return t};t.createAmtDomScript=e=>{const t=e.getAttribute("src")||null,a=(e=>{try{return new URL(e)}catch(e){return i.Logger.error("Failed to get URL from src - "+e.message),null}})(t||"");return{element:e,srcString:t,queryParams:a?a.searchParams:new URLSearchParams,attributes:n(e.attributes),pathname:a?a.pathname:null}}},9791:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCreativeModeAttributes=t.addCreativeIdAttributeToAdTarget=t.ID_ATTRIBUTE=void 0;const i=a(7098);t.ID_ATTRIBUTE="attention-creative-id";t.addCreativeIdAttributeToAdTarget=(e,a)=>{try{e.setAttribute(t.ID_ATTRIBUTE,a)}catch(e){i.Logger.error("Unable to set the attribute")}};t.getCreativeModeAttributes=e=>{try{return{id:e.getAttribute(t.ID_ATTRIBUTE)}}catch(e){return i.Logger.error("Unable to retrieve the attributes"),null}}},82:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentTimestamp=void 0;t.getCurrentTimestamp=()=>(new Date).getTime()},9476:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isUUID4=t.uuidv4=void 0;t.uuidv4=()=>window.crypto?String([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^window.crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)):"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)});t.isUUID4=e=>/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i.test(e)},2627:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendVideoViewableEvent=t.sendFinalProgressEvent=t.sendProgressEvents=t.calculateProgress=t.constructVideoEventProgressConfig=t.PROGRESS_CHECKPOINTS=t.PROGRESS_FALLBACK_THRESHOLD=t.PROGRESS_100_THRESHOLD=void 0;const i=a(4278),n=a(3680),r=a(9599),o=a(2026),s=a(9727),d=a(7098),l=a(7240);t.PROGRESS_100_THRESHOLD=99,t.PROGRESS_FALLBACK_THRESHOLD=98,t.PROGRESS_CHECKPOINTS=[o.ProgressCheckpoint.PLAY_25,o.ProgressCheckpoint.PLAY_50,o.ProgressCheckpoint.PLAY_75,o.ProgressCheckpoint.PLAY_100];t.constructVideoEventProgressConfig=()=>({checkpoints:t.PROGRESS_CHECKPOINTS.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:!1}),{})});t.calculateProgress=(e,t)=>e/t*100;t.sendProgressEvents=(e,a,n,r,c)=>{if(!c||null===a)return void d.Logger.error("No video progress config initialised or total video duration is not available");const u=c.checkpoints,g=(0,t.calculateProgress)(n,a);e.playProgress=g,l.adStore.actions.replaceAd(e);const p=t=>s.globalEventFactory.create("amt:youtube:video-progress",{adId:e.id,checkpoint:t,elapsedDuration:n,totalViewableTime:r});if(g>=o.ProgressCheckpoint.PLAY_75&&!u[o.ProgressCheckpoint.PLAY_75]){const e=p(o.ProgressCheckpoint.PLAY_75);(0,i.captureVideoProgressEvent)(e),l.youtubeStore.set("videoEventCaptureConfig",{checkpoints:Object.assign(Object.assign({},u),{[o.ProgressCheckpoint.PLAY_75]:!0})})}else if(g>=o.ProgressCheckpoint.PLAY_50&&!u[o.ProgressCheckpoint.PLAY_50]){const e=p(o.ProgressCheckpoint.PLAY_50);(0,i.captureVideoProgressEvent)(e),l.youtubeStore.set("videoEventCaptureConfig",{checkpoints:Object.assign(Object.assign({},u),{[o.ProgressCheckpoint.PLAY_50]:!0})})}else if(g>=o.ProgressCheckpoint.PLAY_25&&!u[o.ProgressCheckpoint.PLAY_25]){const e=p(o.ProgressCheckpoint.PLAY_25);(0,i.captureVideoProgressEvent)(e),l.youtubeStore.set("videoEventCaptureConfig",{checkpoints:Object.assign(Object.assign({},u),{[o.ProgressCheckpoint.PLAY_25]:!0})})}};t.sendFinalProgressEvent=(e,a,n,r,d,c)=>{if((0,t.calculateProgress)(a,n)>=c&&d){const t=d.checkpoints;e.playProgress=o.ProgressCheckpoint.PLAY_100,l.adStore.actions.replaceAd(e);const a=s.globalEventFactory.create("amt:youtube:video-progress",{adId:e.id,checkpoint:o.ProgressCheckpoint.PLAY_100,elapsedDuration:1e3*n,totalViewableTime:r});return(0,i.captureVideoProgressEvent)(a),l.youtubeStore.set("videoEventCaptureConfig",{checkpoints:Object.assign(Object.assign({},t),{[o.ProgressCheckpoint.PLAY_100]:!0})}),!0}return!1};t.sendVideoViewableEvent=(e,t,a)=>a.viewableTimeViewportCoverageIntervals&&null!==a.totalIabViewableTime&&!a.viewableCaptured&&(0,r.hasMinimumConsecutiveIabViewableTime)(e,a.totalIabViewableTime)?((0,n.captureViewableEvent)(t,a.totalIabViewableTime,a.viewableTimeViewportCoverageIntervals),!0):a.viewableCaptured},9526:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isAdPaused=t.isAdPlaying=t.isAdInitialising=t.hasYoutubeAdClassName=t.YOUTUBE_AD_INDICATOR_CLASS_NAME=void 0;const i=a(7240);t.YOUTUBE_AD_INDICATOR_CLASS_NAME="ad-showing";t.hasYoutubeAdClassName=()=>{var e;return Array.from((null===(e=i.youtubeStore.get("api"))||void 0===e?void 0:e.classList)||[]).some(e=>e===t.YOUTUBE_AD_INDICATOR_CLASS_NAME)};t.isAdInitialising=e=>(0,t.hasYoutubeAdClassName)()&&e.readyState>=HTMLMediaElement.HAVE_METADATA;t.isAdPlaying=e=>(0,t.hasYoutubeAdClassName)()&&!e.paused&&e.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA;t.isAdPaused=e=>(0,t.hasYoutubeAdClassName)()&&!e.ended&&e.paused&&e.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA},4597:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.waitForBodyElement=void 0;t.waitForBodyElement=()=>new Promise(e=>{if(document.body)e();else{const t=new MutationObserver(()=>{document.body&&(t.disconnect(),e())});t.observe(document.documentElement,{childList:!0})}})},6245:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyEventListenersToDocument=t.DOCUMENT_EVENT_NAMES=t.documentEventNameToHandler=t.hasPageAccess=t.isTopWindow=void 0;const i=a(7240),n=a(9548),r=a(1763),o=a(1878),s=a(7098);t.isTopWindow=e=>e.top===e.self;t.hasPageAccess=e=>{if((0,t.isTopWindow)(e))return!0;try{return!!e.top&&!!e.top.location.hostname}catch(e){return!1}},t.documentEventNameToHandler={visibilitychange:e=>t=>{if(t.target&&t.target.hidden){if(s.Logger.info.withScope("visibilitychange","not visible"),window.__amt_mode__===r.Mode.YOUTUBE){const a=!1,i=!1;(0,n.handleAbandonTrigger)(t,a),(0,o.sendSyntheticGazeEvent)(e,i)}i.youtubeStore.set("isActiveTab",!1)}else t.target&&!t.target.hidden&&(s.Logger.info.withScope("visibilitychange","is visible"),i.youtubeStore.set("isActiveTab",!0))}},t.DOCUMENT_EVENT_NAMES=Object.keys(t.documentEventNameToHandler);t.applyEventListenersToDocument=(e,a)=>{e&&(t.DOCUMENT_EVENT_NAMES.forEach(i=>{e.addEventListener(i,t.documentEventNameToHandler[i](a))}),e.hidden||(s.Logger.log("Set as active tab immediately."),i.youtubeStore.set("isActiveTab",!0)))}},909:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateVideoYoutubeElementByFullScreenToggle=t.getYouTubeMiniPlayerElement=t.getYouTubeVideoElement=t.getYouTubeApiElement=void 0;const i=a(9548),n=a(7240);t.getYouTubeApiElement=e=>e.getElementById(i.YT_PLAYER_ELEMENT_ID);t.getYouTubeVideoElement=()=>{var e;return(null===(e=n.youtubeStore.get("api"))||void 0===e?void 0:e.getElementsByTagName(i.YT_PLAYER_VIDEO_ELEMENT)[0])||null};t.getYouTubeMiniPlayerElement=e=>e.getElementsByTagName(i.YT_MINI_PLAYER_ELEMENT)[0]||null;t.updateVideoYoutubeElementByFullScreenToggle=e=>{const a=(0,t.getYouTubeVideoElement)();n.youtubeStore.set("video",a),e.target=a,n.adStore.actions.replaceAd(e)}},9548:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyClickHandler=t.filterClassesForClickHandler=t.buttonClassToHandler=t.youtubeMiniPlayerTransitionHandler=t.applyFullScreenListener=t.clickThroughHandler=t.skipHandler=t.applyEventListenersToVideo=t.YT_EVENT_NAMES=t.eventNameToHandler=t.handleFallbackCompletionEvent=t.handleFallbackTransition=t.abandonHandler=t.handleAbandonTrigger=t.sendFallbackCompletionEvent=t.elapsedTimeToMilliseconds=t.startYouTubeAdSession=t.fullscreenHandler=t.muteHandler=t.COMMON_CLASS_NAMES=t.YT_MINI_PLAYER_ELEMENT=t.YT_PLAYER_VIDEO_ELEMENT=t.YT_PLAYER_ELEMENT_ID=void 0;const i=a(5751),n=a(2030),r=a(3048),o=a(5990),s=a(6376),d=a(7240),l=a(4559),c=a(9599),u=a(8679),g=a(2627),p=a(9526),E=a(1763),v=a(3426),_=a(909),T=a(7079),m=a(2026),A=a(6581),b=a(9630),I=a(3543),h=a(9727),f=a(7098);t.YT_PLAYER_ELEMENT_ID="movie_player",t.YT_PLAYER_VIDEO_ELEMENT="video",t.YT_MINI_PLAYER_ELEMENT="ytd-miniplayer",t.COMMON_CLASS_NAMES=["ytp-ad-text","ytp-button","ytp-ad-button","ytp-ad-button-link","ytp-ad-image","style-scope","ytd-miniplayer","complex-string","yt-formatted-string","yt-simple-endpoint"];t.muteHandler=(e,t)=>{const a=d.adStore.get("detectedAds"),i=a.length?a[0]:null,n=d.youtubeStore.get("video");if(i&&n){const{muted:e}=n;if(d.youtubeStore.set("isAdMuted",e),t){if(t&&e){const e=h.globalEventFactory.create("amt:youtube:trigger-mute",{adId:i.id,isMuted:!0});(0,r.captureTriggeredEvent)(e)}}else{const t=h.globalEventFactory.create("amt:youtube:trigger-mute",{adId:i.id,isMuted:e});(0,r.captureTriggeredEvent)(t)}}};t.fullscreenHandler=(e,t)=>()=>{const a=d.adStore.get("detectedAds"),i=a.length?a[0]:null;if(i){const a=!!e.fullscreenElement;if(t){if(t&&a){const e=h.globalEventFactory.create("amt:youtube:trigger-fullscreen",{adId:i.id,isFullScreen:!0});(0,r.captureTriggeredEvent)(e)}}else{const e=h.globalEventFactory.create("amt:youtube:trigger-fullscreen",{adId:i.id,isFullScreen:a});(0,r.captureTriggeredEvent)(e),(0,_.updateVideoYoutubeElementByFullScreenToggle)(i)}}};t.startYouTubeAdSession=(e,a,n,r,s=!0)=>{const p=d.youtubeStore.get("video");if(p){const _={target:p,format:"youtube-in-stream-"+(0,l.getAdType)(),pageAccess:!0,topMostAccessibleFrameWindow:window,pageAccessType:A.PageAccessType.FULL},T=I.adFactory.create(A.AdClassType.YOUTUBE,_);if(f.Logger.log("Inserting new ad "+T.id),d.adStore.actions.insertAds([T]),d.youtubeStore.set("adState",v.YOUTUBE_AD_STATE.UNSTARTED),(0,b.pollForVpMetadata)(T),s){const t=(0,l.getYouTubeAdMetadata)();(0,o.captureAdLoadEvent)("amt:load:youtube",{ad:T,instantiationTimestamp:r,entities:e,customMacroValues:a,dataVendor:n,videoMetadata:t})}(0,t.muteHandler)({},!0),(0,t.fullscreenHandler)(document,!0)(),(0,u.captureVideoIntersectionObserverEvents)(T,E.Mode.YOUTUBE),(0,i.captureDataVendorFeatureEvents)(n);const m=(0,c.constructViewableStatus)(),h=(0,g.constructVideoEventProgressConfig)();d.youtubeStore.set("videoViewableStatus",m),d.youtubeStore.set("videoEventCaptureConfig",h),d.youtubeStore.set("videoDuration",(0,l.getDuration)())}};t.elapsedTimeToMilliseconds=e=>Math.round(1e3*e);t.sendFallbackCompletionEvent=(e,t,a)=>{const{videoViewableStatus:i,videoEventCaptureConfig:n}=d.youtubeStore.getMany("videoViewableStatus","videoEventCaptureConfig");i&&n&&(0,g.sendFinalProgressEvent)(e,t,a,i.viewableTimeViewportCoverageIntervals?i.viewableTimeViewportCoverageIntervals[T.ViewportCoverageInterval.INTERVAL_0]:null,n,g.PROGRESS_FALLBACK_THRESHOLD)};t.handleAbandonTrigger=(e,t)=>{const a=d.adStore.get("detectedAds"),i=a.length?a[0]:null;if(i){const e=d.youtubeStore.get("videoViewableStatus");let a=null;i&&e&&e.viewableTimeViewportCoverageIntervals&&(a=e.viewableTimeViewportCoverageIntervals[T.ViewportCoverageInterval.INTERVAL_0]);const n=h.globalEventFactory.create("amt:youtube:trigger-abandon",{adId:i.id,totalViewableTime:a});(0,r.captureTriggeredEvent)(n),t&&(0,s.removeAdTarget)(i)}};t.abandonHandler=e=>{(0,t.handleAbandonTrigger)(e,!0)};t.handleFallbackTransition=(e,a)=>{f.Logger.log("vid_handler - existing ad"),e.playProgress&&e.playProgress<m.ProgressCheckpoint.PLAY_100&&a&&(0,t.abandonHandler)(null)};t.handleFallbackCompletionEvent=(e,a)=>{if(a&&a.playProgress&&!(a.playProgress<g.PROGRESS_FALLBACK_THRESHOLD||a.playProgress>=m.ProgressCheckpoint.PLAY_100))if(e&&e.readyState===HTMLMediaElement.HAVE_NOTHING){const e=d.youtubeStore.get("videoDuration");if(e&&a.playProgress){const i=e/1e3,n=a.playProgress/100*i;(0,t.sendFallbackCompletionEvent)(a,n,i)}}else e&&(0,t.sendFallbackCompletionEvent)(a,e.currentTime,e.duration)},t.eventNameToHandler={canplay:(e,a,i)=>()=>{const n=(0,_.getYouTubeVideoElement)(),r=d.adStore.get("detectedAds"),o=r.length?r[0]:null;if(n&&!o&&(0,p.isAdPlaying)(n)){const r=(new Date).getTime();d.youtubeStore.set("video",n);const o=!1;(0,t.startYouTubeAdSession)(e,a,i,r,o)}},canplaythrough:(e,t,a)=>()=>{f.Logger.log("amt video event - canplaythrough");const i=d.adStore.get("detectedAds"),n=i.length?i[0]:null,r=(0,_.getYouTubeVideoElement)();if(n&&(0,p.isAdPlaying)(r)){const i=(new Date).getTime();d.youtubeStore.set("adState",v.YOUTUBE_AD_STATE.PLAYING);const r=(0,l.getYouTubeAdMetadata)();(0,o.captureAdLoadEvent)("amt:load:youtube",{ad:n,instantiationTimestamp:i,entities:e,customMacroValues:t,dataVendor:a,videoMetadata:r})}},timeupdate:()=>()=>{var e;const{video:a,adState:i}=d.youtubeStore.getMany("video","adState"),r=d.adStore.get("detectedAds"),o=r.length?r[0]:null;if(a&&(0,p.isAdPlaying)(a)&&i===v.YOUTUBE_AD_STATE.PLAYING&&o){const i=(0,l.getDuration)(),r=d.youtubeStore.get("videoEventCaptureConfig"),s=(0,t.elapsedTimeToMilliseconds)(a.currentTime),u=(0,c.getViewableUpdate)(s),p=null!==(e=null==u?void 0:u.totalViewableTime)&&void 0!==e?e:null;(0,n.captureVideoStateMeasureEvent)(o,s,p),(0,g.sendProgressEvents)(o,i,s,p,r);if((0,g.sendFinalProgressEvent)(o,a.currentTime,a.duration,p,r,g.PROGRESS_100_THRESHOLD)&&d.youtubeStore.set("adState",v.YOUTUBE_AD_STATE.ENDED),u){const e=(0,g.sendVideoViewableEvent)(E.Mode.YOUTUBE,o,u);d.youtubeStore.set("videoViewableStatus",{viewableCaptured:e,previousElapsedTime:s,totalIabViewableTime:u.totalIabViewableTime,viewableTimeViewportCoverageIntervals:u.viewableTimeViewportCoverageIntervals})}}},play:()=>()=>{const e=d.adStore.get("detectedAds"),t=e.length?e[0]:null,a=d.youtubeStore.get("video");if(t&&a&&(0,p.isAdPlaying)(a)){d.youtubeStore.set("adState",v.YOUTUBE_AD_STATE.PLAYING);const e=h.globalEventFactory.create("amt:youtube:trigger-play",{adId:t.id});(0,r.captureTriggeredEvent)(e)}},pause:()=>()=>{const e=d.youtubeStore.get("video"),a=d.adStore.get("detectedAds"),i=a.length?a[0]:null;if((0,t.handleFallbackCompletionEvent)(e,i),i&&e&&(0,p.isAdPaused)(e)){const e=h.globalEventFactory.create("amt:youtube:trigger-pause",{adId:i.id});(0,r.captureTriggeredEvent)(e),d.youtubeStore.set("adState",v.YOUTUBE_AD_STATE.PAUSED);const t=d.youtubeStore.get("videoViewableStatus"),a=d.youtubeStore.get("currentVideoInViewPercentage"),n=0;t&&null!==t.totalIabViewableTime&&null!==a&&d.youtubeStore.set("videoViewableStatus",{viewableCaptured:t.viewableCaptured,previousElapsedTime:t.previousElapsedTime,totalIabViewableTime:(0,c.getIabViewableTime)(t.viewableCaptured,t.totalIabViewableTime,n,a),viewableTimeViewportCoverageIntervals:t.viewableTimeViewportCoverageIntervals})}},volumechange:(e,a,i,n)=>()=>{if(n){const{muted:e}=n,a=d.youtubeStore.get("isAdMuted");(e&&!a||!e&&a)&&(0,t.muteHandler)()}},emptied:()=>()=>{const e=d.youtubeStore.get("currentPlayerMode")===v.YOUTUBE_PLAYER_MODE.MINI_PLAYER,a=d.adStore.get("detectedAds"),i=a.length?a[0]:null;i&&(d.youtubeStore.set("adState",v.YOUTUBE_AD_STATE.ENDED),(0,t.handleFallbackTransition)(i,e),(0,s.removeAdTarget)(i))}},t.YT_EVENT_NAMES=Object.keys(t.eventNameToHandler);t.applyEventListenersToVideo=(e,a,i,n)=>{e&&!e.hasAttribute("pxyz-handlers")&&(e.setAttribute("pxyz-handlers",""),t.YT_EVENT_NAMES.forEach(r=>{e.addEventListener(r,t.eventNameToHandler[r](a,i,n,e))}))};t.skipHandler=()=>{f.Logger.log("vid_handler - skip handler");const e=d.adStore.get("detectedAds"),t=e.length?e[0]:null;if(t){const e=d.youtubeStore.get("videoViewableStatus");let a=null;t&&e&&e.viewableTimeViewportCoverageIntervals&&(a=e.viewableTimeViewportCoverageIntervals[T.ViewportCoverageInterval.INTERVAL_0]);const i=h.globalEventFactory.create("amt:youtube:trigger-skip",{adId:t.id,totalViewableTime:a});(0,r.captureTriggeredEvent)(i),(0,s.removeAdTarget)(t)}};t.clickThroughHandler=()=>{const e=d.adStore.get("detectedAds"),t=e.length?e[0]:null;if(t){const e=h.globalEventFactory.create("amt:youtube:trigger-clickthrough",{adId:t.id});(0,r.captureTriggeredEvent)(e)}};t.applyFullScreenListener=e=>{e.addEventListener("fullscreenchange",(0,t.fullscreenHandler)(e))};t.youtubeMiniPlayerTransitionHandler=()=>{d.youtubeStore.set("isMiniPlayerTransition",!0)},t.buttonClassToHandler={[v.YOUTUBE_COMPOSITE_CLASS.AD_SKIP_BUTTON]:t.skipHandler,[v.YOUTUBE_COMPOSITE_CLASS.AD_SKIP_BUTTON_ICON]:t.skipHandler,[v.YOUTUBE_COMPOSITE_CLASS.AD_SKIP_BUTTON_TEXT]:t.skipHandler,[v.YOUTUBE_COMPOSITE_CLASS.AD_BUTTON_TEXT]:t.clickThroughHandler,[v.YOUTUBE_COMPOSITE_CLASS.FLYOUT_HEADLINE]:t.clickThroughHandler,[v.YOUTUBE_COMPOSITE_CLASS.FLYOUT_DESCRIPTION]:t.clickThroughHandler,[v.YOUTUBE_COMPOSITE_CLASS.FLYOUT_ACTION_BUTTON_CONTAINER]:t.clickThroughHandler,[v.YOUTUBE_COMPOSITE_CLASS.FLYOUT_ICON]:t.clickThroughHandler,[v.YOUTUBE_COMPOSITE_CLASS.FLYOUT_TEXT_CONTAINER]:t.clickThroughHandler,[v.YOUTUBE_COMPOSITE_CLASS.VISIT_ADVERTISER_BUTTON]:t.clickThroughHandler,[v.YOUTUBE_COMPOSITE_CLASS.AD_BUTTON_ICON]:t.clickThroughHandler,[v.YOUTUBE_COMPOSITE_CLASS.AD_NEXT_BUTTON]:t.abandonHandler,[v.YOUTUBE_COMPOSITE_CLASS.MINI_PLAYER_CLOSE_BUTTON]:t.abandonHandler,[v.YOUTUBE_COMPOSITE_CLASS.NORMAL_TO_MINI_PLAYER]:t.youtubeMiniPlayerTransitionHandler,[v.YOUTUBE_COMPOSITE_CLASS.MINI_PLAYER_TO_NORMAL]:t.youtubeMiniPlayerTransitionHandler,[v.YOUTUBE_COMPOSITE_CLASS.MINI_PLAYER_TO_NORMAL_DEEP]:t.youtubeMiniPlayerTransitionHandler};t.filterClassesForClickHandler=e=>e.length>1?e.filter(e=>-1===t.COMMON_CLASS_NAMES.indexOf(e)):e;t.applyClickHandler=e=>{e.addEventListener("click",e=>{var a;const i=e.target,n=Array.from((null===(a=null==i?void 0:i.parentElement)||void 0===a?void 0:a.classList)||[]),r=Array.from((null==i?void 0:i.classList)||[]);if(n.length&&r.length){const a=(0,t.filterClassesForClickHandler)(n),i=(0,t.filterClassesForClickHandler)(r),o=`${a.join("-")}_${i.join("-")}`,s=t.buttonClassToHandler[o]||null;s&&s(e)}},!0)}},4559:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getYouTubeAdMetadata=t.getAdType=t.getPositionInContent=t.getDomain=t.getClickThroughUrl=t.getYouTubeAdFromId=t.getDuration=t.getYouTubeAdId=t.AD_DURATION_SECONDS_TOLERANCE=t.MAX_DURATION_BUMPER_AD=t.SKIP_AD_CLASS=void 0;const i=a(7240),n=a(3426),r=a(909),o=a(7098);t.SKIP_AD_CLASS="ytp-ad-skip-ad-slot",t.MAX_DURATION_BUMPER_AD=6,t.AD_DURATION_SECONDS_TOLERANCE=.1;t.getYouTubeAdId=()=>{const e=i.youtubeStore.get("api");return JSON.parse(e.getDebugText()).addebug_videoId};t.getDuration=()=>{const e=i.youtubeStore.get("video");return e&&"number"==typeof e.duration?Math.round(1e3*e.duration):null};t.getYouTubeAdFromId=e=>{var t;const a=null===(t=i.youtubeStore.get("api"))||void 0===t?void 0:t.getPlayerResponse(),n=a?a.adPlacements:[];return n.flatMap(e=>{const t=(e=>{var t;return null===(t=e.adPlacementRenderer.renderer)||void 0===t?void 0:t.instreamVideoAdRenderer})(e),a=(e=>{var t,a;return(null===(a=null===(t=e.adPlacementRenderer.renderer)||void 0===t?void 0:t.linearAdSequenceRenderer)||void 0===a?void 0:a.linearAds.map(e=>e.instreamVideoAdRenderer).filter(e=>!!e))||[]})(e);return t?a.concat(t):a}).find(t=>t.externalVideoId===e)||null};const s=["adurl"];t.getClickThroughUrl=e=>{var t,a;const i=(null===(a=null===(t=null==e?void 0:e.clickthroughEndpoint)||void 0===t?void 0:t.urlEndpoint)||void 0===a?void 0:a.url)||null;if(i)try{const e=new URL(i);return s.map(t=>e.searchParams.get(t))[0]||i}catch(e){o.Logger.error("Could not unwrap clickthrough URL")}return i};t.getDomain=e=>{var t,a,i,n,r,o;return(null===(o=null===(r=null===(n=null===(i=null===(a=null===(t=null==e?void 0:e.playerOverlay)||void 0===t?void 0:t.instreamAdPlayerOverlayRenderer)||void 0===a?void 0:a.visitAdvertiserRenderer)||void 0===i?void 0:i.buttonRenderer)||void 0===n?void 0:n.text)||void 0===r?void 0:r.runs[0])||void 0===o?void 0:o.text)||null};t.getPositionInContent=()=>{const e=i.youtubeStore.get("api").getProgressState();return e.current<1?n.YOUTUBE_POSITION_IN_CONTENT.PRE_ROLL:e.current/e.duration*100>=100?n.YOUTUBE_POSITION_IN_CONTENT.POST_ROLL:n.YOUTUBE_POSITION_IN_CONTENT.MID_ROLL};t.getAdType=()=>{const e=i.youtubeStore.get("video"),a=(0,r.getYouTubeApiElement)(document).querySelectorAll(`[class*=${t.SKIP_AD_CLASS}]`);return!!Array.from(a).length?n.YOUTUBE_IN_STREAM_AD_TYPE.SKIPPABLE:e.duration<=t.MAX_DURATION_BUMPER_AD+t.AD_DURATION_SECONDS_TOLERANCE?n.YOUTUBE_IN_STREAM_AD_TYPE.BUMPER:n.YOUTUBE_IN_STREAM_AD_TYPE.NONSKIPPABLE};t.getYouTubeAdMetadata=()=>{const e=(0,t.getYouTubeAdId)(),a=(0,t.getYouTubeAdFromId)(e);return{adId:e,duration:(0,t.getDuration)(),clickThroughUrl:(0,t.getClickThroughUrl)(a),domain:(0,t.getDomain)(a),youtube:{positionInContent:(0,t.getPositionInContent)(),adType:(0,t.getAdType)()}}}},391:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAdInitialZone=t.instantiateZoneCheckingInterval=t.getZoneForAdTarget=t.createTargetZone=t.ZONE_CHECKING_INTERVAL=void 0;const i=a(3648),n=a(2507),r=a(6581),o=a(7240);t.ZONE_CHECKING_INTERVAL=100;t.createTargetZone=e=>({top:-20,bottom:e.height+20,left:-20,right:e.width+20,height:e.height+40,width:e.width+40,x:-20,y:-20});t.getZoneForAdTarget=(e,a)=>(0,n.doRectanglesIntersect)((0,t.createTargetZone)(a&&a.top?(0,i.getViewportDimensions)(a.top):{width:0,height:0}),e.getBoundingClientRect())?r.Zone.TARGET_ZONE:r.Zone.ZONE_2;t.instantiateZoneCheckingInterval=()=>window.setInterval(()=>{const e=o.adStore.get("detectedAds").map(e=>(e.zone=(0,t.getZoneForAdTarget)(e.target,e.topMostAccessibleFrameWindow),e));o.adStore.set("detectedAds",e)},t.ZONE_CHECKING_INTERVAL);t.getAdInitialZone=e=>e.pageAccess?(0,t.getZoneForAdTarget)(e.target,e.topMostAccessibleFrameWindow):null}},t={};function a(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,a),r.exports}(()=>{const e=a(6752),t=a(4597);document.body?e.app.run(window):(0,t.waitForBodyElement)().then(()=>e.app.run(window))})()})();